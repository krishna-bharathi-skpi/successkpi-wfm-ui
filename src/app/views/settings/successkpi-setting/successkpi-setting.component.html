<!-- <p>successkpi-setting works!</p> -->
<ng2-toasty [position]="'top-center'"></ng2-toasty>

<!-- SuccessKpi-Settings == Preference -->
<div style="margin: 0px 180px 105px 32px; ">
  <div class="top-header" style="justify-content: space-between;">
    <h2 class="header-title">Platform preferences</h2>
  </div>
  <!-- <div class="active-product" style="margin-bottom: 26px;">
        <div class="active-title">Active product modules</div>
        <div style="display: flex;flex-direction: column;">
                <p-checkbox  class="check-box-active" label="Conversational analytics" binary="false"></p-checkbox>
                <p-checkbox  class="check-box-active" label="Speech and text analytics" binary="false"></p-checkbox>
                <p-checkbox  class="check-box-active" label="Evaluations and coaching" binary="false"></p-checkbox>
                <p-checkbox  class="check-box-active" label="Playbook Builder™" binary="false"></p-checkbox>
        </div>
    </div> -->

  <div class="home-dashboard" style="margin-bottom:32px;">
    <!-- <div class="active-title">Active product modules</div>
        <div style="display: flex;margin-bottom: 24px;">
            <label>
              <p-radioButton name="group11" value="company" [(ngModel)]="selectedValue"  [ngModelOptions]="{standalone: true}"label="Company" inputId="preopt11">
              </p-radioButton>
            </label>
            <label>
              <p-radioButton class="any-playbook" name="group12" [(ngModel)]="selectedValue"  [ngModelOptions]="{standalone: true}" value="role" label="Role" inputId="preopt12">
              </p-radioButton>
            </label>
            <label>
            <p-radioButton name="group13" value="user" label="User" [(ngModel)]="selectedValue"  [ngModelOptions]="{standalone: true}" inputId="preopt13">
            </p-radioButton>
            </label>
        </div> -->
    <div class="form-group" style="margin-bottom: 28px;">
      <label class="platform-label">{{global.language?.settings?.preference?.dashboard}}</label>
      <input type="text" id="preferencenameid" class="form-control platform-ipt-box" [(ngModel)]="dashboardId"
        [ngModelOptions]="{standalone: true}" (keypress)="omit_special_char($event)" (ngModelChange)="onPaste($event)"
        autocomplete="off" placeholder="{{global.language?.settings?.preference?.dashboard}}">
    </div>
  </div>

  <!-- <div class="key-questions-center" style="margin-bottom:32px;">
        <div class="active-title">Key Questions cards</div>
        <div style="display: flex;margin-bottom: 24px;">
            <label>
              <p-radioButton name="group11" value="company" [(ngModel)]="selectedValue"  [ngModelOptions]="{standalone: true}"label="Company" inputId="preopt11">
              </p-radioButton>
            </label>
            <label>
              <p-radioButton class="any-playbook" name="group12" [(ngModel)]="selectedValue"  [ngModelOptions]="{standalone: true}" value="role" label="Role" inputId="preopt12">
              </p-radioButton>
            </label>
            <label>
            <p-radioButton name="group13" value="user" label="User" [(ngModel)]="selectedValue"  [ngModelOptions]="{standalone: true}" inputId="preopt13">
            </p-radioButton>
            </label>
        </div>
        <div class="form-group" style="margin-bottom: 28px;">
            <label class="platform-label">Key Questions report handle</label>
            <input type="text" class="form-control platform-ipt-box" placeholder="Home dashboard report handle">
        </div>
    </div> -->
  <div class="cx-platform">
    <div class="form-group platform-group">
      <label class="platform-label">{{global.language?.settings?.preference?.centerDropdwn}}</label>
      <p-dropdown class="choose-platform dplable" [options]="platform" [(ngModel)]="PlatformID"
        [ngModelOptions]="{standalone: true}" placeholder="{{global.language?.settings?.preference?.select}}"
        [disabled]='true'></p-dropdown>
    </div>
  </div>
  <div class="logo-attach">
    <span>{{global.language?.settings?.preference?.logo}}</span>
    <p>{{global.language?.settings?.preference?.l_content}}</p>
  </div>

  <div style="display: flex;margin-bottom: 24px;">
    <label>
      <p-radioButton name="group11" value="default" [(ngModel)]="preferenceModel.isLogoChecked"
        [ngModelOptions]="{standalone: true}" label="Default logo" inputId="preopt1">
      </p-radioButton>
    </label>
    <label>
      <p-radioButton name="group12" value="upload" [(ngModel)]="preferenceModel.isLogoChecked"
        [ngModelOptions]="{standalone: true}" label="Upload logo" inputId="preopt4">
      </p-radioButton>
    </label>

  </div>

  <div class="upload-setting-success" *ngIf="preferenceModel.isLogoChecked != 'default'">
    <img src="../../../../assets/img/microinteraction/upload_file.svg" style="padding-right: 14px;
        margin-top: -4px;">
    <label for="upload-photo" class="upload-id">{{global.language?.settings?.preference?.upload}} &nbsp;{{filename ==
      null ? '' : filename}}</label>
    <input #fileInput type="file" id="upload-photo" accept='image/x-png,image/jpeg' (change)="previewFile()" />
    <img id="blah"
      [src]="fileDataUri || 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBw8PDw0NDQ0PDQ0NDQ0NDQ0NDQ8NDQ0NFREWFhURFRUYHSggGBolGxUVITEhJSkrLi4uFx8zODM4NygtLisBCgoKDQ0NDg0NDysZFRkrKzcrNy0rLS0tNzctLSs3LTcrLTctNy0tKysrLSsrKysrKzcrKy0rLS0rKys3KystK//AABEIALcBEwMBIgACEQEDEQH/xAAYAAEBAQEBAAAAAAAAAAAAAAAAAQIDB//EABsQAQEBAQADAQAAAAAAAAAAAAABEQISIWEx/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAECBAP/xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAMAwEAAhEDEQA/APWJVZlXXu4wQE1RBRpYyqC1lbUAi2oaqUqFqBQ0AAACoaihEAW06TyS0AQBRFBDFQEFBTkWLoM2C0BuKkABDRFIzq8qjSxDUBUNAQ1FQA0QNNEUFhgsQ0SgVBFFQQFEAURqRFQXEAVAFwFFRQBVAEZrVSiIvKCo1CsgNaayCLaamGBDTTAIGgEaiyMojSpoCIKigiogAANMiq0yCAoAommgomgroLoKyioMoKKiKAAAFQa0GVWsiKYACCIqiAAEAGrU6BAAQUFQAAFBBeVBkWqDerayIoiooKgICgIKgQXUQGrUQAAADQETVBAlEBrS1kBRAVRAAAMFRQIvpAVRFBQggAKBBYBgQoCAgICpAAIIqCLhhCCoAAgAAAAgKYiguIICqyoNCAoACqigCAC6gIuiAqoIIqAAACoAKagKAAIoCCoIIoCGqgGoqAogCrrKguiAOkEUaRKAgAAAIACi+kWglRagAAKIoAABAgKnUU6BkAERQRAAANBYvpOaopYFoBKrMaiKAgKAIKmCgAAigiCgqCoAC4CKAACAi6AgAIBgIjWIqICgigKIoIRYRUaA1QReUJQalSmoAIAogIqImqNaMmg3CVmdL5IGmsmqN6M6INCAqiAg0yuijLXkgBigRAFRAAWKTlcRoQBBBAXRBUVAAAz6CaFiaComroAACoAqsrEFUxKCqzq6CiAqoAAgClIYCDNBHQAaTU0BDU0BDQANNADWuoAqdfjACaigoigAaABKAKvVBFRdQBdNQA00FQ01AF56NQBL0oCP/9k='"
      alt="Image" style="width:360px;height:200px;  display: block; border-style: ridge;margin-top: 16px;" />
    <!-- <input #fileInput type="file" class="btn btn-info" accept='image/x-png,image/jpeg'
        (change)="previewFile()" /> -->
  </div>

  <div class="row mb-4">
    <div class="col-sm-2">
      <label class="platform-label">Allow agent feedback</label>
    </div>
    <div class="col-sm-1">
      <p-inputSwitch class="ipt-switch-platform" [(ngModel)]="preferenceModel.allowAgentFeedback"
        (ngModelChange)='preferenceModel.allowAgentFeedback==false? preferenceModel.accept=false && preferenceModel.dispute=false:null;'
        [ngModelOptions]="{standalone: true}"></p-inputSwitch>
    </div>
    <div class="col-sm-6" *ngIf='preferenceModel.allowAgentFeedback'>
      <div class="row">
        <div class="col-sm-3 pl-0">
          <p-checkbox class="check-box-active box-genesys" [(ngModel)]="preferenceModel.accept"
            [ngModelOptions]="{standalone: true}" label="Accept" binary="false"></p-checkbox>
        </div>
        <div class="col-sm-3 pl-0">
          <p-checkbox class="check-box-active box-genesys" [(ngModel)]="preferenceModel.dispute"
            [ngModelOptions]="{standalone: true}" label="Dispute" binary="false"></p-checkbox>
        </div>
      </div>
    </div>
  </div>
    <div class="row mb-2">
      <div class="col-sm-6">
        <label class="bold-head-txt">Transcription Settings</label>
      </div>
    </div>
      <div class="d-flex flex-column lang-label mb-2">
        <label class="platform-label">Call Analytics Type</label>
        <p-dropdown class="choose-platform dplable" [options]="callAnalyticsDDL"
          [(ngModel)]="preferenceModel.callAnalyticsType" [ngModelOptions]="{standalone: true}" (ngModelChange)="conditionChange($event)"
          placeholder="Select Call Analytics Type" [disabled]="isTranscriptionDisable"></p-dropdown>
      </div>
      <div class="d-flex">
      <div class="d-flex flex-column mt-2"
        *ngIf="preferenceModel.callAnalyticsType == 'Call Transcription V1' || preferenceModel.callAnalyticsType == 'Call Transcription V2'">
        <div class="d-flex flex-column ">
          <label class="platform-label mb-3">Language Settings</label>
          <div class="mb-2" style="width: 330px;">
            <div class="row d-flex ml-0">
            <label>
              <p-radioButton name="group17" value="Specific Language Detection"
                [(ngModel)]="preferenceModel.languageDetection" [ngModelOptions]="{standalone: true}"
                label="Specific Language Detection" inputId="preopt8">
              </p-radioButton>
            </label>
            <span style="margin-left: -10px;" ><img src="../../../../assets/img/microinteraction/helptext.svg"
              tooltip="If you know the language spoken in your source audio, choose this option to get the most accurate results. Specific language can be selected with Language (transcription and NLU) option  under CX Center Setting Page"
              placement="right"></span>
            </div>
            <div class="row d-flex ml-0">
            <label>
              <p-radioButton name="group15" value="Automatic Language Detection"
                [(ngModel)]="preferenceModel.languageDetection" [ngModelOptions]="{standalone: true}"
                label="Automatic Language Detection" inputId="preopt6">
              </p-radioButton>
             
            </label>
            <span style="margin-left: -10px;" ><img src="../../../../assets/img/microinteraction/helptext.svg"
              tooltip="If you don’t know the language spoken in your audio files, choose this option. You have access to fewer options for additional processing than if you choose Specific language"
              placement="right"></span>
            </div>
            <div class="row d-flex ml-0" *ngIf="preferenceModel.callAnalyticsType != 'Call Transcription V2'">
            <label >
              <p-radioButton name="group16" value="Automatic Multiple Language Detection"
                [(ngModel)]="preferenceModel.languageDetection" [ngModelOptions]="{standalone: true}"
                label="Automatic Multiple Language Detection" inputId="preopt7">
              </p-radioButton>
            </label>
            <span style="margin-left: -10px;" ><img src="../../../../assets/img/microinteraction/helptext.svg"
              tooltip="If there are multiple languages spoken in your audio files and you’re not sure what these languages are, choose this option. This selection provides limited additional processing options compared to Specific language"
              placement="right"></span>
            </div>
          </div>
          <div class="d-flex ">
          <div class="flex-column mb-2" style="width: min-content;" *ngIf="preferenceModel.languageDetection != 'Specific Language Detection'">
            <label style="width: max-content;" class="platform-label">Language options for automatic language identification - <em>optional:</em>
              <span class="ml-2"  ><img src="../../../../assets/img/microinteraction/helptext.svg"
                tooltip="To improve accuracy, choose at least two languages spoken the most often in your audio library. SuccessKPI NLU Engine chooses from one of the languages you’ve specified to transcribe each audio file. Leave this field empty if you're unsure about which languages to select"
                placement="right"></span>
            </label>
            <p-multiSelect class="multiselect-custom-virtual-scroll data-access-ddl" [style]="{'width':'398px'}"
              [options]="languageDetectDDL" [(ngModel)]="preferenceModel.lanuageDetectionOption"
              [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} language selected"
              defaultLabel="Select Language" [virtualScroll]="true" itemSize="37" [showToggleAll]="false">
            </p-multiSelect>
          </div>
            <div class="pr-0 label-section ml-4" style="width: 60%;height: 75px;"  *ngIf="preferenceModel.languageDetection != 'Specific Language Detection' && (preferenceModel.callAnalyticsType == 'Call Transcription V1' || preferenceModel.callAnalyticsType == 'Call Transcription V2')">
              <button class="select-label mr-2 mb-2 label-odd"
                *ngFor="let customLabel of preferenceModel.lanuageDetectionOption">
                {{customLabel}}
                <i class="fa fa-times-circle cross-btn" aria-hidden="true" (click)="deleteLabel(customLabel)"></i>
              </button>
            </div>
          </div>
          
        </div>
      </div>
      
      </div>
        <div class="mb-2" *ngIf="preferenceModel.callAnalyticsType == 'Call Transcription V1'">
          <div class="row mb-2">
            <div class="col-sm-4">
              <label class="platform-label">Audio Identification Type</label>
            </div>
          </div>
          <div class="row" >
            <div class="col-sm-12 " style="display: flex;">
              <label class="mt-2">
                <p-radioButton name="group19" value="Channel Detection"
                  [(ngModel)]="preferenceModel.audioIdentificationType" [ngModelOptions]="{standalone: true}"
                  label="Channel Detection" inputId="preopt9" [disabled]="isTranscriptionDisable">
                </p-radioButton>
              </label>
              <label class="mt-2">
                <p-radioButton name="group20" value="Speaker Detection"
                  [(ngModel)]="preferenceModel.audioIdentificationType" [ngModelOptions]="{standalone: true}"
                  label="Speaker Detection" inputId="preopt10" [disabled]="isTranscriptionDisable">
                </p-radioButton>
              </label>
           
            <div style="margin-top: -26px;" *ngIf="preferenceModel.audioIdentificationType == 'Speaker Detection'">
              <label>Speaker Label</label>
              <input type="number" style="border: 1px solid #c9cdd1;" class="form-control  choose-intervals"
                (keypress)="keyPress($event)" [(ngModel)]="preferenceModel.speakerLabelValue"
                [ngModelOptions]="{standalone: true}" placeholder=""
                (ngModelChange)="speakerLabelValidator(preferenceModel.speakerLabelValue)" minlength="1" maxlength="2"
                autocomplete="off" [disabled]="isTranscriptionDisable">
            </div>
          </div>
          </div>
        </div>
  
  <div class="errormsg-topic" *ngIf="isValidator">Please Enter Speaker value Between 2 to 10 </div>


  <div class="save-btns mt-3" *ngIf="global.rolePermissions.settings.preferences.isViewEdit == true">
    <button type="button" class="btn-save" (click)="savePreference()"
      [disabled]="loading">{{global.language?.settings?.preference?.save}}</button>
  </div>
</div>