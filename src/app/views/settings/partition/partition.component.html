<!-- <p>partition works!</p> -->
<ng2-toasty [position]="'top-center'"></ng2-toasty>

<div *ngIf="dataAccessList.length > 0">
<!-- List of partition from DB -->
  <div style="margin: 0px 180px 30px 32px;" *ngIf="_partitionPage == 'partitionList'">
    <div class="top-header" style="justify-content: space-between;">
      <h2 class="header-title">Data partitions (Beta)</h2>
    </div>

    <!-- Partition List -->
    <div class="roles-cards">
        <div style="margin: 0;padding: 0;" *ngIf="getList.length > 0">
            <div class="card-center" *ngFor = "let item of getList">
                <div class="card-data">
                    <h5 class="card-content text-ellipsis-card">{{item.partitionName}}</h5>
    
                    <div class="card-link" (click)="addEditPage(item,'edit')">
                        <img src="../../../../assets/img/microinteraction/edit.svg" style="padding-right:8px;">
                        Edit
                    </div>
    
                </div>
            </div>
        </div>

        <div *ngIf="getList.length == 0" style="padding-left: 3px;">
          No partition available !
        </div>
    </div>

    <div class="add-center" *ngIf="global.rolePermissions.settings.dataPartition.isViewEdit == true">
        <button type="button" style="outline: 0px;" class="add-btn" (click)="addEditPage('','create')">
            <img src="../assets/img/microinteraction/add_item.svg">
            <span class="btn-txt-add">&nbsp;Create Partition</span>
          </button>
    </div> 
  </div>

  <!-- Create/ Edit partition -->
  <div style="margin: 32px 110px 0px 32px;min-height: 100vh;" *ngIf="_partitionPage == 'create_edit'">
    <div>
        <img src="../../../../assets/img/back.svg">
        <ul class="breadcrumb">
          <li><label class="bread-crumb-label1" (click)="breadCrumbBack()">All partitions</label></li>
        </ul>
    </div>
    <div class="edit-header">
        <div class="row" style="justify-content:space-between;margin-bottom: 18px !important;">
          <div class="page-title col-sm-7">
            <h2 *ngIf="createEdit=='create'">Create partition</h2>
            <h2 *ngIf="createEdit=='edit'" class="platform-name-ellipsis"><span *ngIf="partitionModel.partitionName == ''">Edit Partition</span><span *ngIf="partitionModel.partitionName != ''">{{partitionModel.partitionName}}</span></h2>
          </div>
          <div class="col-sm-5" 
            style="text-align: right;" *ngIf="createEdit=='edit' && global.rolePermissions.settings.dataPartition.isViewEdit == true">
            <button type="button" class="btn-delete" data-toggle="modal" data-target="#deleteModal">Delete partition</button>
          </div>
        </div>
    </div>

    <div class="edit-role-ipt">
        <form>
            <div class="" style="margin-top: 30px;">
                <div class="form-group" style="margin-bottom: 28px;margin-top: 24px;">
                    <label class="platform-label">Partition name</label>
                    <input type="text" id="partitionnameid" class="form-control platform-ipt-box" [(ngModel)]="partitionModel.partitionName"  [ngModelOptions]="{standalone: true}" (keypress)="omit_special_char($event)" (ngModelChange)="onPaste($event)"
                    [ngClass]="partitionNameERR == true ? 'is-invalid' : false " placeholder="Partition name" autocomplete="off">
                    <div class="errormsg-topic" *ngIf="partitionNameERR == true">Please enter partition name</div>
                </div>
                
                <div>
                    <div class="row" *ngFor="let item of partitionModel.dataPartitionList;let i=index" style="height: 100px;">
                        <div class="col-sm-3">
                          <div class="role-option-title font-weight-normal">{{item.dataLabel}}</div>
                          <div style="display: flex;justify-content: space-between;margin-bottom: 24px;">
                              <label class="">
                                <p-radioButton  value="all" [(ngModel)]="item.dataValue"  [ngModelOptions]="{standalone: true}" label="All">
                                </p-radioButton>
                              </label>
                              
                              <label  class="">
                                <p-radioButton class="any-playbook" [(ngModel)]="item.dataValue"  [ngModelOptions]="{standalone: true}" value="custom" label="Custom" (onClick)="onRadioSelect(item.dataValue,item.dataLabel)">
                                </p-radioButton>
                              </label>
                          </div>
                        </div>
                        <div class="col-sm-3" style="padding: 24px 0px;" *ngIf="item.dataValue == 'custom'">
      
                        <p-multiSelect  [options]="ddl_custom_List" [(ngModel)]="item.dataList" [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} data selected"  defaultLabel="Choose data filter" (onFocus)="ddlModelValue(item.dataLabel)" [virtualScroll]="true"  [itemSize]="34" class="multiselect-custom-virtual-scroll data-access-ddl" [showToggleAll]="false"></p-multiSelect>
      
                        </div>
      
                        <div class="col-sm-6 pr-0 label-section" *ngIf="item.dataValue == 'custom'">
                          <!-- <div> -->
                          <button class="select-label mr-2 mb-2" [ngClass]="getStyle(i)" *ngFor="let customLabel of item.dataList">
                            {{customLabel}}
                            <i class="fa fa-times-circle cross-btn" aria-hidden="true" (click)="deleteLabel(customLabel)"></i>
                          </button>
                          <!-- </div> -->
                        
                        </div>
      
                    </div>
                      
                    <div class="errormsg-topic" *ngIf="dataAccessErr == true">Please select atleast 1 data option filter, if custom filter is selected</div>
                </div>
                <div class="mt-3 save-btns" *ngIf="global.rolePermissions.settings.dataPartition.isViewEdit == true">
                    <button type="button" class="btn-save" *ngIf="createEdit=='edit'" (click)="updatePartition()">Save</button>
                    <button type="button" class="btn-save" *ngIf="createEdit=='create'" (click)="savePartition()">Save</button>
                </div>
            </div>
    
    
        </form>
    </div>
  </div>
</div>

<div *ngIf="dataAccessList.length == 0">
  <div style="margin: 0px 180px 30px 32px;">
    <div class="top-header" style="justify-content: space-between;">
      <h2 class="header-title">Data partitions</h2>
    </div>
    <div style="padding-left: 3px;">
      Not supported for this platform !
    </div>
  </div>
</div>



<!-- Delete popup box -->
<div class="modal" id="deleteModal" data-backdrop="static">
    <div class="modal-dialog">
      <div class="modal-content delete-popup">
  
        <!-- Modal Header -->
        <div class="modal-header" style="border-bottom: 0;">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
  
        <!-- Modal body -->
        <div class="modal-body">
          <div class="delete-popup-content" style="margin-left: -8%;">
            <img src="../assets/img/glyphs_messaging/glyph_danger.svg" style="margin-top: -10px;
                margin-right: 20px;">
            <h5>Are you sure you want to delete this partition ?</h5>
          </div>
        </div>
  
        <!-- Modal footer -->
        <div class="modal-footer " style="border-top: 0px;">
          <div style="margin-left: 8.6%;">
            <button type="button" class="btn-pop-del" data-dismiss="modal" (click)="deletePartition()">Delete partition</button>
            <button type="submit" class="btn-pop-cancel" data-dismiss="modal">Cancel</button>
          </div>
        </div>
  
      </div>
    </div>
</div>