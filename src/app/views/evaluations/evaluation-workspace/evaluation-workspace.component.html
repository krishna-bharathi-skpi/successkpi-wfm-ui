<ng2-toasty [position]="'top-center'"></ng2-toasty>

<!-- <p>evaluation-workspace works!</p> -->
<!-- <div class="evalution-workspace-title">
    <div class="row">
        <div class="col-lg-10 col-sm-4">
            <div class="page-title">
                <h2>{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.title }}</h2>
            </div>
        </div>
    </div>
</div> -->
<div class="top-header">
    <div class="col">
        <h2 class="header-title">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.title }}</h2>
    </div>
</div>

<div class="interactions-sort mb-3" style="height: 54px;">
    <div class="row" style="padding: 12px 20px;width: 100%;">
        <div style="padding: 0 16px;">
            <div class="evaluate-sub-title"><h3 style="margin-top: 3px;">Pick your Evaluation Form</h3></div>
        </div>
        <div class="" style="padding: 0 16px;width: 35%;">
            <div class="form-group">
                <p-dropdown class="dropdown-interaction dplable" [options]="EvalItemDDL" [(ngModel)]="category"
                   (onChange)="onChangeBlur()" [ngModelOptions]="{standalone: true}" filter="true"
                     placeholder="{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.select}}">
                </p-dropdown>
            </div>
        </div>
        <div class="" style="padding: 0 16px;width: 20%;">
            <button type="button" id="refresh-btn-dossier" class="btn-sort-interaction" tooltip="Loads the selected evaluation form" placement="top"><i class="fa fa-sign-in mr-3" style="font-size: 15px;" aria-hidden="true"></i>Load Workspace</button>
        </div>
        <div class="" style="padding: 0 16px;width: 20%;">
            <button type="button" class="btn-sort-interaction" (click)="reloadWorkspace()" tooltip="Refresh your display and reset your entire selection" placement="top"><i class="fa fa-refresh mr-3" style="font-size: 15px;" aria-hidden="true"></i> Refresh Session</button>
        </div>
    </div>
</div>

<div class="interactions-sort mb-3">
    <div class="sort-left" [ngStyle]="{'pointer-events' : isloadSpinner == true ? 'none' : 'auto'}">
        <div class="evaluate-sub-title">
            <h3>{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.title}}</h3>
        </div>
        <div > 
            <!-- <div class="row">
                <div class="col-sm-12">
                    <div class="form-group mb-1">
                        <label class="interaction-label">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.form}}</label>
                        <p-dropdown class="dropdown-interaction" [options]="EvalItemDDL" [(ngModel)]="category"
                           (onChange)="onChangeBlur()" [ngModelOptions]="{standalone: true}" filter="true"
                             placeholder="{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.select}}">
                        </p-dropdown>
                    </div>
                </div>
            </div> -->
         
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group mb-1">
                        <label class="interaction-label">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.from}}</label>
                        <div>
                            <img src="../assets/img/microinteraction/calendar.svg" class="calendar-img">
                            <p-calendar class="interaction-calendar calendar-resize-workspace" [(ngModel)]="fromDate"
                                placeholder="MM/DD/YYYY" [monthNavigator]="true" [yearNavigator]="true"
                                yearRange="2000:2050" (onSelect)="OnchangeDateFilter()"></p-calendar>
                        </div>
                    </div>

                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-1">
                        <label class="interaction-label">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.to}}</label>
                        <div>
                            <img src="../assets/img/microinteraction/calendar.svg" class="calendar-img">
                            <p-calendar class="interaction-calendar calendar-resize-workspace" [(ngModel)]="toDate"
                                placeholder="MM/DD/YYYY" [monthNavigator]="true" [yearNavigator]="true"
                                yearRange="2000:2050" (onSelect)="OnchangeDateFilter()"></p-calendar>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-12">
                    <div class="form-group mb-1">
                        <label class="interaction-label">Conversation ID</label>
                        <p-autoComplete placeholder="Type to search" class="ipt-interaction-form"
                        [(ngModel)]="convCategory" [suggestions]="resultConvID"
                        (completeMethod)="searchConversation($event)" (onSelect)="OnchangeConversation()" (onBlur)="EmptyFun()"
                        ></p-autoComplete>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-12">
                    <div class="form-group mb-1">
                        <label class="interaction-label">
                            {{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.agent}}</label>
                        <p-autoComplete placeholder="Type to search" class="ipt-interaction-form"
                            [(ngModel)]="agentCategory" [suggestions]="resultAgent"
                            (completeMethod)="searchAgents($event)" (onSelect)="OnchangeAgent()" (onBlur)="EmptyFun()"></p-autoComplete>
                    </div>
                </div>

            </div>
            
            <div class="row">
                <div class="col-sm-12">
                    <div class="form-group mb-1">
                        <label class="interaction-label">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.queue}}</label>

                        <p-autoComplete placeholder="Type to search" class="ipt-interaction-form"
                            [(ngModel)]="queueCategory" [suggestions]="resultQueue"
                            (completeMethod)="searchQueues($event)" (onSelect)="OnchangeQueue()" (onBlur)="EmptyFun()"></p-autoComplete>
                    </div>
                </div>
            </div>
            
            <!-- <div class="row">
                <div class="col-sm-12">
                    <div class="form-group mb-1">
                        <label class="interaction-label">Evaluator Username</label>

                        <p-autoComplete placeholder="Type to search" class="ipt-interaction-form"
                            [(ngModel)]="evalUserCategory" [suggestions]="resultEvalName"
                            (completeMethod)="searchEvalUser($event)" (onSelect)="OnchangeEvalUsername()" (onBlur)="EmptyFun()"></p-autoComplete>
                    </div>
                </div>
            </div> -->
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group mb-1">
                        <label class="interaction-label">Evaluator Username</label>

                        <p-autoComplete placeholder="Type to search" class="ipt-interaction-form"
                            [(ngModel)]="evalUserCategory" [suggestions]="resultEvalName"
                            (completeMethod)="searchEvalUser($event)" (onSelect)="OnchangeEvalUsername()" (onBlur)="EmptyFun()"></p-autoComplete>
                    </div>

                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-1">
                        <label class="interaction-label">Team</label>

                        <p-autoComplete placeholder="Type to search" class="ipt-interaction-form"
                            [(ngModel)]="teamCategory" [suggestions]="resultTeams"
                            (completeMethod)="searchTeams($event)" (onSelect)="OnchangeTeam()" (onBlur)="EmptyFun()"></p-autoComplete>
                    </div>
                </div>
            </div>

            <div class="row">
                
                <div class="col-sm-12">
                    <div class="form-group mb-1">
                        <label class="interaction-label">Status</label>
                        <p-dropdown class="dropdown-interaction dplable" [options]="statusDDL" [(ngModel)]="statusModel"
                         [ngModelOptions]="{standalone: true}"  (onChange)="OnchangeStatus()" placeholder="Select a status">
                        </p-dropdown>
                    </div>
                </div>

            </div>
            
            <!-- <div class="row">
                <div class="col-sm-12">
                    <div class="form-group mb-1">
                        <label class="interaction-label">Team</label>

                        <p-autoComplete placeholder="Type to search" class="ipt-interaction-form"
                            [(ngModel)]="teamCategory" [suggestions]="resultTeams"
                            (completeMethod)="searchTeams($event)" (onSelect)="OnchangeTeam()" (onBlur)="EmptyFun()"></p-autoComplete>
                    </div>
                </div>
            </div> -->

            <!-- <div class="row mb-4">
                <div class="col-sm-7">
                    <div class="form-group mb-1">
                        <label class="interaction-label">Handle Time</label>
                        <div>
                        <p-dropdown class="dropdown-interaction" [options]="handleTDDL" [(ngModel)]="handleModel"
                        [ngModelOptions]="{standalone: true}"placeholder="Handle Time">
                        </p-dropdown>
                        </div>
                    </div>

                </div>
                <div class="col-sm-5">
                    <div class="form-group mb-1">
                        <br>
                        <input type="number" class="ipt-interaction-number form-control" min="0" [(ngModel)]="timeIptModel"
                        (ngModelChange)="onChangeTime(timeIptModel)" [ngModelOptions]="{standalone: true}">
                    </div>
                </div>
                <div class="errormsg-topic" *ngIf="errhandleTime==true" style="font-size: 13px;padding: 0;margin-left: 4%;">Handle time minimum value will be '0'</div>
            </div> -->
           
            <!-- <div class="row">
                <div class="col-sm-12">
                    <div class="form-group">
                        <label class="interaction-label">Status</label>
                        <p-dropdown class="dropdown-interaction" [options]="cities" [(ngModel)]="selectedCity"
                            [ngModelOptions]="{standalone: true}" optionLabel="name" placeholder="Select a City">
                        </p-dropdown>
                    </div>
                </div>
            </div> -->

            <!-- <div class="row">
                <div class="col-sm-12">
                    <img src="../assets/img/refresh.svg" style="position: absolute;
                z-index: 99;
                top: 8px;
                left: 28%;">
                    <button type="button" id="refresh-btn-dossier" class="btn-sort-interaction" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.sortInteraction?.refresh}}</button>
                </div>
            </div> -->
        </div>
     
    </div>

    <div class="sort-right">
        <div class="evaluate-sub-title mb-1">
            <h3>{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.title}}</h3>
            <div class="" style="margin-right: 9px;margin-top: -4px;width: 22%;">
                <button type="button" class="btn-sort-interaction" (click)="ReloadData()"  tooltip="Pull and display the latest data" placement="top"><i class="fa fa-repeat mr-3" style="font-size: 15px;" aria-hidden="true"></i> Refresh Data</button>
            </div>
        </div>
        <div class="table-view">
            <!-- <table class="table table-bordered table-hover table-responsive-sm">
                <thead style="background-color: #f4f4f4;border: 1px solid #B3B6C7;text-align: center;">
                   
                    <tr>
                        <th class="table-head" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.CallStartTime}}</th>
                        <th class="table-head" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.CallerID}}</th>
                        <th class="table-head" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.QueueName}}</th>
                        <th class="table-head" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.AgentName}}</th>
                        <th class="table-head" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.TalkTime}}</th>
                        <th class="table-head" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.WaitTime}}</th>
                        <th class="table-head" >{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.HandleTime}}</th>
                    </tr>
                </thead>
                <tbody *ngFor="let evDataCol0 of pagedItems">
                    <tr (click)="getEvaluateObj(evDataCol0)" [class.highlight]="evDataCol0.a === currentContact">
                        <td [attr.rowspan]="evDataCol0.sp">{{evDataCol0.c}}</td>
                        <td [attr.rowspan]="evDataCol0.sp">{{evDataCol0.b}}</td>
                        <td [attr.rowspan]="evDataCol0.sp">{{evDataCol0.q}}</td>
                        <td [attr.rowspan]="evDataCol0.sp">{{evDataCol0.e}}</td>
                        <td>{{evDataCol0.h}}</td>
                        <td>{{evDataCol0.i}}</td>
                        <td>{{evDataCol0.j}}</td>
                    </tr>
                    <tr *ngFor="let evDataCol1 of evDataCol0.k" (click)="getEvaluateObj(evDataCol0)"
                        [class.highlight]="evDataCol0.a === currentContact">
                        <td>{{evDataCol1.n}}</td>
                        <td>{{evDataCol1.o}}</td>
                        <td>{{evDataCol1.p}}</td>
                    </tr>
                </tbody>
            </table> -->
            <div id="errorDossierId" style="width: 100%; display: hidden !important; height: 100%; font-size: 11px; display: flex; align-items: center; justify-content: center; color: lightgray; font-weight: bold;">
                <!-- <p>There are no conversations found</p> -->
                <p>No data returned for this view. This might be because the applied filter excludes all data.</p>
            </div>
            <div id="dossierContainer1" style="width: 100%; height: 100%;"></div>

            <div style="text-align: center;height: 100%;align-items: center;display: grid;" *ngIf="isloadSpinner">
                <p-progressSpinner></p-progressSpinner>
            </div>
        </div>


        <!-- <ul *ngIf="pager.pages && pager.pages.length" class="pagination justify-content-center">
            <li [ngClass]="{disabled:pager.currentPage === 1}">
                <a (click)="setPage(1)">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.first}}</a>
            </li>
            <li [ngClass]="{disabled:pager.currentPage === 1}">
                <a (click)="setPage(pager.currentPage - 1)">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.previous}}</a>
            </li>
            <li *ngFor="let page of pager.pages" [ngClass]="{active:pager.currentPage === page}">
                <a (click)="setPage(page)">{{page}}</a>
            </li>
            <li [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                <a (click)="setPage(pager.currentPage + 1)">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.next}}</a>
            </li>
            <li [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                <a (click)="setPage(pager.totalPages)">{{global.language?.evaluations?.evaluationWorkspace?.evaluationTop?.selectInteraction?.tableSection?.last}}</a>
            </li>
        </ul> -->

        <!-- <div class="table-loader" *ngIf="istableGet">
            <p-progressSpinner></p-progressSpinner>
        </div> -->

    </div>
</div>

<div class="interaction-players-data mt-0 mb-4">
    <div class="player-left" style="margin-right: 24px;height: 636px;">
        <div class="player-title">
            {{global.language?.evaluations?.evaluationWorkspace?.evaluationbottom?.bottomLeft?.title}}</div>
            <div style="position: relative;">
                <div class="row" style="text-align: center">
                    <div class="col-md-12">
                        <!-- <div id="wave-timeline" style="margin-top: 14px;"></div>
                        <div id="audio-spectrum" style="height: 100px;" (click)="getTimeMediaPlayer()">
                            </div> -->

                            <div *ngIf=" transcriptTab[0]?.from_user_emailid!=undefined" class="noAudioNoNACD">
                                <h4 style="color: #D10606;">No Audio Data Available</h4>
                                <p class="noAudioNoNACD-sub">Audio Data is only
                                    associated with voice based conversations selected from the grid</p>
                            </div>
                            <div id="wave-timeline" *ngIf="transcriptTab[0]?.from_user_emailid==undefined" style="margin-top: 14px;"></div>
                            <div id="audio-spectrum" *ngIf="transcriptTab[0]?.from_user_emailid==undefined" style="height: 100px;" (click)="getTimeMediaPlayer()">
                            </div> 

                    </div>
                </div>
                <br />
                <br />
                <div id="controls" *ngIf="transcriptTab[0]?.from_user_emailid==undefined">
                    <span id="refresh-btn" class="plspan"><i class="fa fa-refresh fa-fw" aria-hidden="true"
                            data-toggle="tooltip" (click)="refreshBtn()" title="Refresh"></i></span>
                    <span id="previous-btn" class="plspan"><i class="fa fa-backward fa-fw" aria-hidden="true"
                            data-toggle="tooltip" (click)="skipBackward()" title="Backward"></i></span>
                    <span id="play-btn" class="plspan" value="play"><i class="fa fa-play fa-fw" aria-hidden="true"
                            data-toggle="tooltip" (click)="playandpause()" title="Play/Pause"></i></span>
                    <span id="next-btn" class="plspan"><i class="fa fa-forward fa-fw" aria-hidden="true"
                            data-toggle="tooltip" (click)="skipForward()" title="Forward"></i></span>
    
                    <span id="mute" class="plspan" (click)="volumeChange();" style="margin-left: 0px;"><i
                            class="fa fa-fw fa-volume-up" aria-hidden="true" data-toggle="tooltip"
                            title="Mute/Unmute"></i></span>
    
                    <span id="notes" class="notes-style" (click)="addnotes()"><i class="fa fa-sticky-note"
                            aria-hidden="true" data-toggle="tooltip" title="Add Notes"></i></span>
                </div>
    
                <div id="note-icon" class="notes-popup card-postion" *ngIf="notesPopup == true">
                    <div class="form-group ">
                        <div><label class="interaction-label">Add notes</label><label style="float: right;
                            margin-bottom: 4px;" (click)="closenotes()"><button type="button" class="close"
                                    style="outline: 0 !important;">&times;</button></label></div>
                        <input type="text" class="form-control ipt-notes-box" [(ngModel)]="notesModel.notes"
                            [ngModelOptions]="{standalone: true}" name="notes" maxlength="128" autocomplete="off">
                        <div class="errormsg-topic" *ngIf="errValNotes==true" style="font-size: 11px;padding: 0;">Please
                            enter the notes</div>
                        <div class="errormsg-topic" *ngIf="conversationID==true" style="font-size: 11px;padding: 0;">Please
                            select interactions for saving notes</div>
                        <div class="errormsg-topic" *ngIf="errTime==true" style="font-size: 11px;padding: 0;">Please select
                            time from media player </div>
                    </div>
    
                    <div>
                        <button type="button" class="save-note-btn" (click)="saveNotes()">Save</button>
                    </div>
                </div>
            </div>

        <p-tabMenu [model]="items1" [activeItem]="items1[0]">
        </p-tabMenu>
        <!-- sutharsan starts -->
        <div class="overflow-eval-workspace" *ngIf="tabMenuName==='Topics'">
            <!-- <br /> -->
            <div *ngIf="getTopicReport?.length>0">
                <div class="row hover-topic" *ngFor="let topic of getTopicReport; let i=index"  style="cursor: pointer;padding: 0 15px;">
                   
                    <!-- <div class="col-md-1" class="numberCircle" (click)="findTopic_Audio(topic,timeConvert)">
                        <b>{{i+1}}</b>
                    </div>
                    <div class="col-md-10" style="cursor: pointer;">
                        <label class="col-form-label tp">{{topic.element.name}}</label>
                    </div> -->
                    <div class="" *ngFor="let topicTime of topic.children;let i=index;" style="display: flex;width: 100%;">
                
                        <div class="hover-topic-report1 mb-1 col-md-2" style="width: auto;cursor: pointer;" (click)="trancriptSF(topicTime.element.name)"> [{{topicTime.element.name | timeConvert}}]</div>
                        <div class="hover-topic-report2 mb-1 col-md-10"  *ngIf = "i == 0"  >{{topic.element.name}}</div>
                        
                    </div>
                    <br />
                    <br />
                </div>

            </div>

            <div *ngIf="getTopicReport?.length==0 || currentContact == '' ">
                Topics not found!
            </div>
        </div>

        <div class="overflow-eval-workspace" *ngIf="tabMenuName==='Transcript'">
            <!-- <p>Transcript Data Process</p> -->
            <div *ngIf="currentContact != '' ">
                <div *ngFor="let tcItem of transcriptTab; let i=index">
                    <div *ngIf="tcItem?.from_user_emailid==undefined" class="row conv hover-conversation">
                        <!--(click)="trancriptSF(tcItem.start_time)"-->
                        <div class="col-md-4 hover-data1" style="left: 12px; " (click)="trancriptSF(tcItem.start_time)">
                            <label *ngIf="tcItem.channel =='Agent' || tcItem.channel =='AGENT'" class="col-form-label">
                                <img src="../../../../assets/img/Evaluation Workspace/icon_user_transcripts.svg" style="background-color: #30BCED;
                                border-radius: 100%;
                                width: 25px;
                                height: 25px;
                                padding: 3px;
                                cursor: pointer;">
                                <span
                                    style="cursor: pointer;margin-left: 8px;">[{{tcItem.start_time|timeConvert}}]</span></label>
                            <label *ngIf="tcItem.channel =='Customer' || tcItem.channel =='CUSTOMER'" class="col-form-label">
                                <img src="../../../../assets/img/Evaluation Workspace/icon_user_transcripts.svg" style="  background-color: #98DFAF;
                                border-radius: 100%;
                                width: 25px;
                                height: 25px;
                                padding: 3px;
                                cursor: pointer;">
                                <span
                                    style="cursor: pointer;margin-left: 8px;"><b>[{{tcItem.start_time | timeConvert}}]</b></span></label>
                            <label *ngIf="tcItem.channel =='Workflow' || tcItem.channel =='WORKFLOW'" class="col-form-label">
                                <img src="../../../../assets/img/Evaluation Workspace/icon_user_transcripts.svg" style="background-color: #3A3E50;
                                border-radius: 100%;
                                width: 25px;
                                height: 25px;
                                padding: 3px;
                                cursor: pointer;">
                                <span
                                    style="cursor: pointer;margin-left: 8px;">[{{tcItem.start_time|timeConvert}}]</span></label>
                        </div>
                        <div class="col-md-8 hover-data2" style="right: 50px;">
                            <label *ngIf="tcItem.channel =='Agent' || tcItem.channel =='AGENT'" class="col-form-label"><span>{{tcItem.text}}</span></label>
                            <label *ngIf="tcItem.channel =='Customer' || tcItem.channel =='CUSTOMER'" class="col-form-label"><span><b>{{tcItem.text}}</b></span></label>
                            <label *ngIf="tcItem.channel =='Workflow' || tcItem.channel =='WORKFLOW'" class="col-form-label"><span>{{tcItem.text}}</span></label>
                        </div>
                    </div>
                </div>
                <div>
                    <div *ngIf="transcriptTab[0]?.from_user_emailid!=undefined" class="row conv hover-conversation">
                        <p-accordion>
                            <p-accordionTab header="&nbsp;({{tcItem.from_username}} - {{tcItem.channel}})&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{tcItem.start_time}}" *ngFor="let tcItem of transcriptTab; let i=index">
                                <label class="col-form-label"><b>From :&nbsp;</b><span>{{tcItem.from_user_emailid}}&nbsp;({{tcItem.from_username}})</span></label><br>
                                <label class="col-form-label"><b>To :&nbsp;</b><span>{{tcItem.to_user_emailid}}&nbsp;({{tcItem.to_username}})</span></label><br>
                                <label class="col-form-label"><b>Date Time :&nbsp;</b><span>{{tcItem.start_time}}</span></label><br>
                                <label class="col-form-label"><b>Subject :&nbsp;</b><span>{{tcItem.subject}}</span></label><br>
                                <label class="col-form-label"><b>Text :&nbsp;</b><span>{{tcItem.text}}</span></label><br>
                            </p-accordionTab>
                        </p-accordion>
                    </div>
                </div>
            </div>

            <div *ngIf="currentContact == '' || transcriptTab?.length == 0">
                Transcript not found!
            </div>
        </div>
        <!-- sutharsan end -->
        <div class="overflow-eval-workspace" *ngIf="tabMenuName==='Notes'">
            <div *ngIf="allNotes.length>0">
                <div *ngFor="let item of allNotes; let i=index">
                    <div class="row conv notes-hover hover-conversation">
                        <!--(click)="trancriptSF(tcItem.start_time)"-->
                        <div class="col-md-3 hover-notes-data1" style="left: 10px;" (click)="trancriptSF(item.time)">
                            <label class="col-form-label">
                                <span style="cursor: pointer;margin-left: 8px;">[{{item.time|timeConvert}}]</span>
                            </label>
                        </div>
                        <div class="col-md-8 hover-notes-data2" style="right: 20px;">
                            <label class="col-form-label"><span>{{item.notes}}</span>
                            </label>

                        </div>
                        <div class="col-md-1 hover-data3 pl-0">
                            <img src="../../../../assets/img/microinteraction/delete.svg" data-toggle="modal"
                                data-target="#myModal" (click)="deletepopup(item)">
                        </div>
                    </div>
                </div>
            </div>


            <div *ngIf="allNotes.length==0 || currentContact == ''">
                <!-- <br> -->
                Notes not found!
            </div>
        </div>
    </div>

    <div class="player-right">
      <div class="score-card" style="height: 526px;">
        <div class="evaluation-form">
            <h3>{{global.language?.evaluations?.evaluationWorkspace?.evaluationbottom?.bottomRight?.title}} : {{evalRoomName}}</h3>
            <div class="" *ngIf="AgentDDL">
                <div class="row">
                    <div class="col-sm-6 pt-1" style="font-size: 13px;color: #9e9a9a;overflow-x: hidden;
                    white-space: nowrap; text-overflow: ellipsis;" tooltip = "{{currentContact}}" position="bottom">
                        Conversation ID : <span style="cursor: pointer;">{{currentContact}}</span>
                    </div>
                    <div class="col-sm-6 pl-0">
                        <div class="d-flex">
                            <label style="width: 20%;" class=" pt-1">Agent:</label>&nbsp;
                            <div style="width: 80%;">
                                <p-dropdown class="dropdown-interaction dplable" [options]="agentDDLform" [(ngModel)]="evalFormAgent" (onChange)="getEvalutionDetail()" [ngModelOptions]="{standalone: true}" placeholder="Select an Agent">
                                </p-dropdown>
                            </div>
                        </div> 
                    </div>
                    
                </div>
                <div class="row" *ngIf="(ismoderator && allowResubmit) || (allowResubmit && evaluatorDropdown.length > 1)">
                    <div class="col-sm-6">
                        <div class="d-flex">
                            <label class=" pt-1">Evaluator:</label>&nbsp;
                            <div class="w-100">
                                <p-dropdown class="dropdown-interaction dplable" [options]="evaluatorDropdown" (onChange)="getEvaluationAns()" [(ngModel)]="selectedEvaluator"  [ngModelOptions]="{standalone: true}" placeholder="No Evaluator yet">
                                </p-dropdown>
                            </div>
                        </div> 
                    </div>
                </div>
               
            </div>
        </div>
        <div style="text-align: center; font-weight: 500;"
            *ngIf="questionsList ==  undefined || questionsList ==  null">
            No data available for selected evaluation form
        </div>
        <div class="eval-container-center" style="overflow-y: scroll;overflow-x: hidden;height: 78%;" [ngStyle]="{'height' : (ismoderator && allowResubmit) || (allowResubmit && evaluatorDropdown.length > 1) ? '71%' :'78%'}">
            <div class="evaluate-container" *ngFor="let evalItem of questionsList;let j = index;">
                <div class="evaluate-sub-title" *ngIf="evalItem.topicShowHide">
                    <h4>{{evalItem.Topics.topicName}} 
                        <!-- <span>(Max Score {{evalItem.score}})</span> -->
                    </h4>
                </div>
                <div class="evaluate-subdiv" *ngFor="let ques of evalItem.Topics.questions let i = index;">
                    <div class="row" *ngIf="ques?.conditionalSkipQuestion==true">
                    <!-- <div class="row"> -->
                        <div class="col-sm-7 pr-0">
                            <div class="ques-loop-icon w-100">
                                <!--data-toggle="tooltip" title={{ques.question}}-->
                                <div style="display: flex;width: 89%;">
                                    <!-- <span class="ev-wrkspace-forms"> {{i+1}}.</span>  -->
                                    <span class="evaluate-order-list line-clamp" tooltip="{{ques.question}}"
                                        placement="top">{{ques.question}}</span>
                                        <!-- <sup *ngIf="ques.questionMandatory" style="font-size: 7px;color:#afa7a7;"><i class="fa fa-asterisk" aria-hidden="true"></i></sup> -->
                                </div>
                                <!-- <div class="ques-ev-forms"> <span class="ev-wrkspace-forms"> {{i+1}}.</span> {{ques.question}}</div>
                               <div class='tooltips'>
                                {{ques.question}}
                               </div> -->
                               <div style="width: 10%;">
                                <span *ngIf="ques.questionMandatory" style="font-size: 10px;margin-top: 4px;
                                color:#afa7a7;"><i class="fa fa-asterisk" aria-hidden="true"></i></span>
                               
                                <span class="info-icon-style" *ngIf="ques.questionDescription != undefined && ques.questionDescription != '' " (click)="conformPopOver(i,j)">
                                    <i class="fa fa-info-circle cursor-pointer" aria-hidden="true" tooltip="{{ques.questionDescription}}"
                                    placement="bottom"></i>
                                </span>

                                <div *ngIf="ques.questionDescription != undefined && ques.questionDescription != '' ">
                                    <div class="confirm-box-style" *ngIf="isConformBox && indexTexti == i && indexTextj == j">Do you want to copy question description ? &nbsp;&nbsp;&nbsp;<i class="fa fa-clone copy-tick-ico mr-2" aria-hidden="true" (click)="tickFun(i,j,ques.questionDescription)"></i> <i class="fa fa-times-circle-o ml-1 copy-coss-ico" aria-hidden="true" (click)="crossFun(i,j)"></i></div>
                                </div>
                                <div *ngIf="ques.questionDescription != undefined && ques.questionDescription != '' ">
                                    <div class="cpy-txt" *ngIf="isCopy && indexTexti == i && indexTextj == j"><i class="fa fa-check-circle-o copy-tick-ico" aria-hidden="true" style="color: #0D7744;"></i> Description copied !</div>
                                </div>
                                
                                </div>
                            </div>
                            
                        </div>
                        <div class="col-sm-5 mt-2">
                            <div class="form-group" *ngIf="ques.questionChoice=='Number' || ques.questionChoice == null && ques.questionChoice !='Comments'"
                                style="display: flex;flex-direction: column;">
                                <label *ngIf="i==0" style="margin-top: -15%;">{{global.language?.evaluations?.evaluationWorkspace?.evaluationbottom?.bottomRight?.score}}</label>
                                <input type="number" autocomplete="off" class="evaluate-score-box form-control"
                                [(ngModel)]="ques.numberValue" [ngModelOptions]="{standalone: true}" (ngModelChange)="CalculateScore(); conditionalSkipQuestionShow(j, i, questionsList, 0);ConditionalSkipCheckMaxvalue(ques.numberValue, j, i, ques.questionValue)" 
                                (keypress)="keyPress($event)" placeholder="{{ques.questionValue}}" [disabled]="disableqa">
                            </div>
                            <div class="form-group"
                                *ngIf="ques.questionChoice !='Number' && ques.questionChoice != null && ques.questionChoice !='Comments'">
                                <p-dropdown class="dropdwn-category dplable" [options]="ques.questionData"
                                    [(ngModel)]="ques.answerdata" [ngModelOptions]="{standalone: true}" (ngModelChange)="CalculateScore(); conditionalSkipQuestionShow(j, i, questionsList, 0);"
                                    placeholder="Select" [disabled]="disableqa">
                                </p-dropdown>
                            </div>
                            <div class="form-group"
                                *ngIf="ques.questionChoice =='Comments' && ques.questionChoice !='Number' ">
                                <textarea maxlength="2048"name="comments" class="form-control" id="commentid" style="display: flex;width: 100%;border: 1px solid #a6a6a6;" (keypress)="textAreaKeys($event)"
                                [(ngModel)]="ques.answerdata" (ngModelChange)="CalculateScore(); ReplaceSlashFuctionEvaluationForm(ques.answerdata, j, i);; conditionalSkipQuestionShow(j, i, questionsList, 0);" 
                                [ngModelOptions]="{standalone: true}" cols="15" rows="2" [ngModelOptions]="{standalone: true}" placeholder="{{ques.questionValue}}"></textarea> 

                                <!-- <textarea maxlength="2048" name="comments" class="form-control" id="commentid" style="display: flex;width: 100%;border: 1px solid #a6a6a6;"
                      [(ngModel)]="ques.answerdata" cols="15" rows="2" (keypress)="textAreaKeys($event)"
                      [ngModelOptions]="{standalone: true}" (ngModelChange)="CalculateScore(); ques.answerdata=ReplaceSlashFuctionEvaluationForm(ques.answerdata)" placeholder="{{ques.questionValue}}" ></textarea> -->
                      <!-- [disabled]="disableqa" -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- <div *ngIf="global.rolePermissions.evaluate.evaluationWorkspace.isViewEdit == true">
            
            <div class="save-evaluate-btn" *ngIf="questionsList?.length>0">
                <div style="width: 20%;margin-top: 5px;">
                    <p-checkbox  class="check-box-active box-genesys" label="Coached"  [(ngModel)]="evaluatesaveModel.evaluation_coach" [ngModelOptions]="{standalone: true}" binary="false"></p-checkbox>
                </div>
                <div class="form-group">
                    <button type="submit" data-toggle="tooltip" title={{tooltip}} class="btn-save" [disabled]="loading"
                        (click)="evaluationWorkSpaceSave('In Progress')">{{global.language?.evaluations?.evaluationWorkspace?.evaluationbottom?.bottomRight?.save}}</button>
                    <button type="submit" data-toggle="tooltip" class="btn-save"
                        [disabled]="loading" (click)="evaluationWorkSpaceSave('Complete')">Submit</button>
                </div>
            </div>
        </div> -->
      </div>

      <div class="score-card" style="margin: 1% 0;">
        <div class="score-card-data">
            <div>Questions: <span style="color: #8AAEF5;">{{totalQues}}</span> / <span style="color: #0D4DCE;">{{totalCountQues}}</span> </div>
            <div>Notes: <span style="color: #8AAEF5;">{{totalNotes}}</span> / <span style="color: #0D4DCE;">{{totalCountNotes}}</span> </div>
            <div>Score: <span style="color: #0D4DCE;">{{totalScore}}</span> 
        </div>
        </div>
      </div>

      <div class="score-card">
        <div class="">
            <div *ngIf="global.rolePermissions.evaluate.evaluationWorkspace.isViewEdit == true">
            
                <div class="save-evaluate-btn justify-content-end"  *ngIf="questionsList?.length>0">
                    <!-- <div style="width: 20%;margin-top: 5px;">
                        <p-checkbox  class="check-box-active box-genesys" label="Coached"  [(ngModel)]="evaluatesaveModel.evaluation_coach" [ngModelOptions]="{standalone: true}" binary="false" [disabled]="coachFlag || disablecoach"></p-checkbox>
                    </div> -->
                    <!-- <div style="font-size: 15px;font-weight: 600;margin-top: 6px;color: gray;"> -->
                        <!-- Questions: <span style="color: #0D4DCE;">{{totalQueAns}}</span> &nbsp;&nbsp;
                        Notes: <span style="color: #0D4DCE;">{{TotalComment}}</span> &nbsp;&nbsp; -->
                        <!-- Score: <span style="color: #0D4DCE;">{{totalScore}}</span> &nbsp;&nbsp;
                    </div> -->
                    <div class="form-group">
                        <span id="modalOpen" data-toggle="modal" data-target="#resetModal"></span>
                        <button type="submit" class="btn-delete mr-3" (click)="resetModel()" *ngIf="ismoderator == true || localRole.toLowerCase() == 'admin'">Reset</button>
                        <button type="submit" data-toggle="tooltip" title={{tooltip}} class="btn-save" [disabled]="saveFlagDisable || disableqa "
                          [ngClass]="saveFlagDisable == true || disableqa  ? 'savebtn-disable' : 'btn-save'"  (click)="evaluationWorkSpaceSave('In Progress')">{{global.language?.evaluations?.evaluationWorkspace?.evaluationbottom?.bottomRight?.save}}</button>
                        <button type="submit" data-toggle="tooltip" class="btn-save mr-0"
                         [ngClass]="disableqa  ? 'savebtn-disable' : 'btn-save'"(click)="evaluationWorkSpaceSave('Complete')" [disabled]=" (loading ||  disableqa )">Submit</button>
                    </div>
                </div>
            </div>
        </div>
      </div>
    </div>

    
</div>

<!--Delete modal  -->
<div class="modal" id="myModal" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content delete-popup">

            <!-- Modal Header -->
            <div class="modal-header" style="border-bottom: 0;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <div class="delete-popup-content">
                    <img src="../assets/img/glyphs_messaging/glyph_danger.svg" style="margin-top: -10px;
                margin-right: 20px;">
                    <h5>Are you sure you want to delete this interaction notes?</h5>
                </div>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer " style="border-top: 0px;">
                <div style="margin-left: 3.6%;">
                    <button type="button" class="btn-pop-del" data-dismiss="modal" (click)="deleteNotes()">Delete
                        notes</button>
                    <button type="button" class="btn-pop-cancel" data-dismiss="modal">Cancel</button>

                </div>
            </div>

        </div>
    </div>
</div>

<!-- Reset Modal -->
<div class="modal" id="resetModal" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content delete-popup">

            <!-- Modal Header -->
            <div class="modal-header" style="border-bottom: 0;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <div class="delete-popup-content">
                    <img src="../assets/img/glyphs_messaging/glyph_danger.svg" style="margin-top: -4px;margin-right: 18px;height: 26px;">
                    <h5>Are you sure you want to reset this evaluation ?</h5>
                </div>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer " style="border-top: 0px;">
                <div style="margin-left: 3.6%;">
                    <button type="button" class="btn-pop-del" data-dismiss="modal" style="width: 80px;" (click)="resetData()">Yes</button>
                    <button type="button" class="btn-pop-cancel" data-dismiss="modal">No</button>

                </div>
            </div>

        </div>
    </div>
</div>
