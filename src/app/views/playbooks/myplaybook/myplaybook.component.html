<ng2-toasty [position]="'top-center'"></ng2-toasty>


<!-- <p>myplaybook works!</p> -->
<div style="margin: 0px 110px 0 32px; " *ngIf="createEdit== 'list'">
    <div class="top-header" style="justify-content: space-between;">
          <h2 class="header-title">{{ global.language?.playbooks?.myPlaybooks?.title }}</h2>

    <div style="display: flex;margin-right: 10px;">
      <div style="margin-top: -20px;">
        <i class="fa fa-search" aria-hidden="true" style="
                      position: relative;
                      left: 5px;
                      opacity: 0.6;
                      top: 29px;
                     "></i>
        <input type="text" class="inp-searchs form-control" [(ngModel)]="searchPlaybookName"
          (ngModelChange)="searchPlaybook()" placeholder="{{global.language?.playbooks?.myPlaybooks?.search}}">
      </div>
      <div style="margin:0 16px">
        <button type="button" class="btn-templates"
          (click)="getTemplateItem();createEdit='template'">{{global.language?.playbooks?.myPlaybooks?.template }}</button>
      </div>
      <div>
        <button type="button" class="btn-creates" *ngIf = "global.rolePermissions.playbooks.myPlaybooks.isViewEdit == true"
          (click)="openCreatePlaybook()">{{global.language?.playbooks?.myPlaybooks?.create }}</button>
      </div>
    </div>
  </div>

  <!-- playbook display Content -->
  <section style="margin: 10px 0;">
    <div class="row" *ngIf = "global.rolePermissions.playbooks.myPlaybooks.isViewEdit == true || global.rolePermissions.playbooks.myPlaybooks.isView == true">
      <div *ngFor="let playbookCards of cards;let i = index" class="col-sm-6 col-lg-3 playbook-cards" >
        <div class="card  bg-info">
          <div style="display: flex;">
            <div>
              <img src="../assets/img/TilePatterns/Pattern_Playbooks.svg">
            </div>
            <div class="card-body ">
              <div style="text-align: right; margin-top: 10%;">
                <span class="on-off-toggle"
                  style="top: -6px;">{{playbookCards.active == true ? global.language?.playbooks?.myPlaybooks?.on : global.language?.playbooks?.myPlaybooks?.off}}</span>
                <p-inputSwitch [(ngModel)]="playbookCards.active" (onChange)="togglePlaybook(playbookCards)">
                </p-inputSwitch>
              </div>
              <div class="card-title module line-clamp" style="margin: 30px 0 30px;"
                (click)="updatePlaybook(playbookCards)">{{playbookCards.playbookName }}</div>
              <div class="card-desc module line-clamp-desc" (click)="updatePlaybook(playbookCards)">
                {{playbookCards.playbookDescription}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<!--********************************************************** Edit Playbooks********************************************************** -->
<div style="margin: 40px 195px 50px 32px;min-height: 100vh;" *ngIf="createEdit== 'edit'">
  <div>
    <img src="../../../../assets/img/back.svg">
    <ul class="breadcrumb">
      <li><label class="bread-crumb-label1"
          (click)="editCancel()">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.breadcrumb}}</label></li>
    </ul>
  </div>
  <div class="edit-header">
    <div class="row" style="justify-content:space-between;margin-bottom: 18px !important;">
      <div class="page-title col-sm-10">
        <h2>{{playbookModel.playbookName}}</h2>
      </div>
      <div class="col-sm-2" data-toggle="modal" data-target="#myModal"
        style="padding-left:0px;padding-right: 0px;text-align: right;" *ngIf = "global.rolePermissions.playbooks.myPlaybooks.isViewEdit == true">
        <button type="button"
          class="btn-delete">{{global.language?.playbooks?.myPlaybooks?.EditPlaybook?.deleteBtn}}</button>
      </div>
    </div>
  </div>

  <div>
    <form [formGroup]="playbookEditForm">
      <!--(ngSubmit)="onSubmitEdit()"-->
      <div class="form-group">
        <div class="row" style="margin-top: 30px;">
          <div class="col-sm-6">
            <div class="row">
              <div class="col-sm-12 name-description" style="margin-bottom: 4px;">
                <span>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookName}}</span>
                <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
                    tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.tooltipName}}"
                    placement="right"></span>
                <span style="float: right;font-weight: 400 !important;">44
                  {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.characters}}</span>
              </div>
              <div class="col-sm-12">
                <input type="text" id="playbooknameid" class="form-control ipt-edit" maxlength="44" [(ngModel)]="playbookModel.playbookName" (ngModelChange)="onPaste($event)" (keypress)="omit_special_char($event)"
                  formControlName="playbookNameEdit"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookName}}"
                  autocomplete="off"
                  [ngClass]="{ 'is-invalid': (submittedEdit || validationEdit.playbookNameEdit.touched) && validationEdit.playbookNameEdit.errors}"
                  style="height: 56px;">
                <div
                  *ngIf="(submittedEdit || validationEdit.playbookNameEdit.touched )&& validationEdit.playbookNameEdit.errors"
                  class="is-invalid ">
                  <div class="errormsg-topic is-invalid"
                    *ngIf="(submittedEdit ||  validationEdit.playbookNameEdit.touched) && validationEdit.playbookNameEdit.errors.required"
                    style="padding: initial;">
                    {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookNameError}}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-sm-6 ">
            <div class="row">
              <div class="col-sm-12 name-description" style="margin-bottom: 4px;">
                <span>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookDescription}}</span>
                <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
                    tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.tooltipDesc}}"
                    placement="right"></span>
                <span style="float: right;font-weight: 400 !important">70
                  {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.characters}}</span>
              </div>
              <div class="col-sm-12">
                <input type="text" class="form-control ipt-edit" maxlength="70" name="name" autocomplete="off"
                  [(ngModel)]="playbookModel.playbookDescription" [ngModelOptions]="{standalone: true}" 
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookDescription}}"
                  style="height: 56px;">
              </div>
            </div>
          </div>
        </div>

        <p-overlayPanel #op for="op" [showCloseIcon]="true" appendTo="body" [style]="{width: '830px'}" [autoZIndex]="true"   [dismissable]="false">
          <div class="p-3">
            <div class="source-title mb-3">Define rules</div>
            <div class=" mb-2 ">
              <div style="display: flex;">
              <label>
                <p-radioButton name="group1" value="all"  [(ngModel)]="playbookModel.filterConditionType"  [ngModelOptions]="{standalone: true}" label="All criteria met" inputId="preopt1" >
                </p-radioButton>
             </label>
             <label>
              <p-radioButton name="group2" value="any"  [(ngModel)]="playbookModel.filterConditionType"  [ngModelOptions]="{standalone: true}" label="Any criteria met" inputId="preopt2">
              </p-radioButton>
            </label>
            </div>
            </div>
            <div class="filter-section border-0" >
            <div class="row mb-3 ml-1 " style="display: flex;"  *ngFor="let edit of playbookModel.filterConditions; let i=index">
              <div>
                <p-dropdown class="dp-label" [style]="{'width':'220px'}" [options]="metricOption" [(ngModel)]="edit.conditionFilterName"  [ngModelOptions]="{standalone: true}" placeholder="Select"
               (onChange)="filterMetricNameValidation(edit.conditionFilterName,i)" ></p-dropdown>
              </div>
              <div style="padding-left: 20px;" *ngIf="edit.conditionFilterName != 'Media Type' && edit.conditionFilterName != 'Interaction Start Time (UTC)'">
                <p-dropdown [style]="{'width':'190px'}" class="dplable" [options]="listDropdown" [(ngModel)]="edit.conditionFilterType"
                  placeholder="Select Filter Type"
                  [ngModelOptions]="{standalone: true}" [disabled]="edit.conditionFilterName === null"></p-dropdown>
              </div>
              <div style="padding-left: 20px;" *ngIf="edit.conditionFilterName == 'Media Type'">
                <p-multiSelect class="multiselect-custom-virtual-scroll data-access-ddl" [style]="{'width':'260px'}" [options]="mediaTypeOption" [(ngModel)]="edit.conditionFilterValue" [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} data selected" (ngModelChange)="filterMetricOnChange(edit.conditionFilterValue,i,'editmetric')" defaultLabel="Select "  [virtualScroll]="true" itemSize="34"  [showToggleAll]="false"></p-multiSelect>
              </div>
              <div style="padding-left: 20px;" *ngIf="edit.conditionFilterName != 'Media Type' && edit.conditionFilterName != 'Interaction Start Time (UTC)'">
                <p-multiSelect class="multiselect-custom-virtual-scroll data-access-ddl" [style]="{'width':'260px'}" [options]="metricValueOption" [(ngModel)]="edit.conditionFilterValue" [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} data selected" (ngModelChange)="filterMetricOnChange(edit.conditionFilterValue,i,'editmetric')"  defaultLabel="Select value" (onFocus)="getMetricValueData(edit.conditionFilterName)" [virtualScroll]="true" itemSize="34"  [showToggleAll]="false" [disabled]="edit.conditionFilterType == null" ></p-multiSelect>
              </div>
              <div style="padding-left: 20px;" *ngIf="edit.conditionFilterName == 'Interaction Start Time (UTC)'">
                <p-multiSelect class="multiselect-custom-virtual-scroll data-access-ddl" [style]="{'width':'190px'}" [options]="filterWeekDays" [(ngModel)]="edit.conditionFilterValue" [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} data selected" (ngModelChange)="filterMetricOnChange(edit.conditionFilterValue,i,'editmetric')"  defaultLabel="Select day of week"  [virtualScroll]="true" itemSize="34"  [showToggleAll]="false" ></p-multiSelect>
              </div>
              <div  class="d-flex" *ngIf="edit.conditionFilterName == 'Interaction Start Time (UTC)'">
                <div class="d-flex" style="padding-left: 20px;">
                  <p-calendar class="timer-input"   [(ngModel)]="edit.conditionFilterStartTime" [ngModelOptions]="{standalone: true}" [timeOnly]="true" [hourFormat]="24" inputId="timeonly" [readonlyInput]="true"  (ngModelChange)="filterTimeOnChange(edit.conditionFilterStartTime,edit.conditionFilterEndTime)" placeholder="Start Time" [disabled]="edit.conditionFilterValue.length == 0"></p-calendar>
                  <i class="fa fa-clock-o clock-icon" aria-hidden="true"></i>
                </div>
                  <div class="d-flex" style="padding-left: 5px;">
                    <p-calendar class="timer-input"  [(ngModel)]="edit.conditionFilterEndTime" [ngModelOptions]="{standalone: true}" [timeOnly]="true" [hourFormat]="24" inputId="timeonly" [readonlyInput]="true"   (ngModelChange)="filterTimeOnChange(edit.conditionFilterStartTime,edit.conditionFilterEndTime)" placeholder="End Time" [disabled]=" edit.conditionFilterStartTime == null"></p-calendar>
                    <i class="fa fa-clock-o clock-icon" aria-hidden="true"></i>
                  </div>
              </div>
                  
            
              <div>
                <button class="btn-delete-icon" type="button" (click)="removeFilterConditionCreate(i,'removeedit')" 
                  style="margin-top: 3px;" [ngStyle]="{ 'margin-left': edit.conditionFilterName == 'Interaction Start Time (UTC)' ? '0px' : '16px'}">
                  <img src="../assets/img/microinteraction/delete.svg" style="margin-left: -5px;margin-top: 3px;width: 16px;">
                </button>
              </div>
            </div>
            </div>
            <div class="errormsg-topic" *ngIf="metricOptionErr">Cannot choose same filter option, once if option is already existed! </div>
            <div class="errormsg-topic" *ngIf="metricValueErr">Please select atleast 1 filter condition option</div>
            <div class="errormsg-topic" *ngIf="addConditionErr">Condition is already Exist,Please select option</div>
            <div class="errormsg-topic" *ngIf="isFilterTimeError">Interaction End Time must be greater than of Interaction Start Time! </div>
            <div class="errormsg-topic" *ngIf="isFilterEqualTimeError">Cannot choose Interaction Start Time as Interaction End Time!</div>
            <div class="errormsg-topic" *ngIf="isFilterErr">Please Choose the Interaction Start Time and Interaction End Time!</div>
            <div class="d-flex justify-content-between mt-2 ml-0" >
              <button type="button" class="add-btn"   (click)="addFilterConditionCreate('edit')" [disabled]="isAddDisable">
                <label class="d-flex" style="align-items: center;text-decoration: none;" [ngClass]="{'btn-txt-add' : !isAddDisable , 'btn-txt-grey': isAddDisable }" >
                  <span  style="font-size: 28px;">+ </span>&nbsp;
                  <span  class="pt-1">Add Criteria</span>
                </label>
              </button>
              <div>
                <button type="button" class="btn-save" style="float: right" [ngClass]="{'btn-save' : !isDisableDone , 'btn-save-disable': isDisableDone}" (click)="addFilterDefinition($event,op)" [disabled]="isDisableDone" >Done</button>
              </div>
            </div>
          </div>
        </p-overlayPanel> 

        <div class="edit-condition" style="margin-bottom: initial;">
          <div class="d-flex">
          <h4>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.Conditions}}
            <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
                tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.tooltip}}"
                placement="right"></span>
          </h4>
          <label class="ml-2">
            <button type="button" style="outline: 0px;" class="add-btn" (click)="op.show($event)">
              <span class="btn-con-add">Filters&nbsp;</span>
                <img src="../assets/img/microinteraction/edit.svg">
              </button>
          </label>
          </div>
          <p>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.ConditionDesc}}</p>
          <div>
            <div style="display:flex;margin-bottom: 6px;" *ngFor="let conn of playbookModel.cfacondition; let i=index">
              <div class="no-div">
                <h6>{{i+1}}</h6>
              </div>
              <div class="form-group mr-3">
                <p-dropdown class="choose-action dplable" [options]="conditionDdl" [(ngModel)]="conn.Dimension"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.category}}"
                  [ngModelOptions]="{standalone: true}" (ngModelChange)="defaultChannelVal(conn)"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension == 'Metrics'">
                <p-dropdown class="theme-selection dplable" [options]="metricOptions" [(ngModel)]="conn.Metrics" 
                  placeholder="Select a Metrics" [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension == 'Metrics'">
                <p-dropdown class="choose-Condition dplable" [options]="metricOperations" [(ngModel)]="conn.Condition" 
                  placeholder="Select a Operation" [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension == 'Metrics'&& conn.Condition == '>=<='">
                <input type="text" class="score-theme form-control choose-content" [(ngModel)]="conn.Measure"
                  [ngModelOptions]="{standalone: true}" placeholder="1-10" max="100" (keypress)="keyPress($event)"/>
              </div>
              <!-- <div class="form-group" style="margin-left: 12px;" *ngIf="conn.Dimension == 'Metrics' && conn.Condition == '>=<='">
                <input type="number" class="score-theme form-control choose-content metric-number-type" [(ngModel)]="conn.measureFrom"
                  [ngModelOptions]="{standalone: true}" max="100" />
              </div>
              <div *ngIf="conn.Dimension == 'Metrics'&& conn.Condition == '>=<='" class="and-value">AND</div>
              <div class="form-group" style="margin-left: 12px;" *ngIf="conn.Dimension == 'Metrics'&& conn.Condition == '>=<='">
                <input type="number" class="score-theme form-control choose-content metric-number-type" [(ngModel)]="conn.measureTo"
                  [ngModelOptions]="{standalone: true}" max="100" />
              </div> -->
              <div class="form-group mr-3" *ngIf="conn.Dimension == 'Sentiment'">
                <p-dropdown class="choose-Condition dplable" [options]="channelList" [(ngModel)]="conn.Channel" 
                  placeholder="Select a Channel" [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension!='Score' && conn.Dimension != 'Metrics'">
                <p-dropdown class="choose-condition dplable" [options]="topicSentimentCondition" [(ngModel)]="conn.Condition"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.operation}}"
                  [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension=='Score'">
                <p-dropdown class="theme-selection dplable" [options]="themeLists" [(ngModel)]="conn.Theme" filter="true"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.theme}}"
                  [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension=='Score'">
                <p-dropdown class="choose-condition dplable" [options]="scoreCondition" [(ngModel)]="conn.Condition"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.operation}}"
                  [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension!='Score'&& conn.Dimension!='Sentiment' && conn.Dimension != 'Metrics'">
                <p-dropdown class="choose-content dplable" [options]="TopicsList" [(ngModel)]="conn.Measure" filter="true"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.value}}"
                  [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension=='Score' ||(conn.Dimension == 'Metrics' && conn.Condition != '>=<=')">
                <input type="number" class="score-theme form-control choose-content" [(ngModel)]="conn.Measure"
                  [ngModelOptions]="{standalone: true}" max="100">
              </div>
              <div class="form-group mr-3" *ngIf="conn.Dimension=='Sentiment'">
                <p-dropdown class="choose-condition dplable" [options]="sentimentList" [(ngModel)]="conn.Measure"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.value}}"
                  [ngModelOptions]="{standalone: true}"></p-dropdown>
              </div>
              <div class="form-group ">
                <button class="btn-delete-icon" type="button" (click)="removeConditionEdit(i)"
                  >
                  <img src="../assets/img/microinteraction/delete.svg" style="margin-top: 3px;">
                </button>
              </div>
            </div>
            <!-- <span *ngIf="errorValidation.conditionError!=null" class="errormsg-topic"
              style=" position: relative; top: -14px;">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.conditionError}} 1</span> -->
              <span class="errormsg-topic" style="  position: relative; top: -14px;"
              *ngIf="errorValidation.conditionError!=null && errorValidation.conditionError!='' ">{{errorValidation.conditionError}}</span>
              <div class="errormsg-topic" *ngIf="errBetween == true" style=" position: relative; top: -14px;">“Between” operator requires a range like 1-10</div>
            <div class="errormsg-topic" *ngIf="errSameValue == true" style=" position: relative; top: -14px;">“Between” operator do not accept a same range (1-1)</div>  
          </div>
        </div>
       
        <div>
          <button type="button" class="add-btn" style="margin-bottom: 24px;outline: 0px;" (click)="addCondition()">
            <img src="../assets/img/microinteraction/add_item.svg">
            <span
              class="btn-txt-add">&nbsp;{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.addCondition}}</span>
          </button>
        </div>
        <div class="trigger-condition">
          <div>
            <h5>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerTitle}}
              <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
                  tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.tooltipTrigger}}"
                  placement="right"></span>
            </h5>
          </div>
          <div style="display: flex;">
            <label>
              <p-radioButton name="group11" value="AND" (click)="changeLogicEdit(1)"
                label="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerall}}"
                [(ngModel)]="playbookModel.cfaOperator" [ngModelOptions]="{standalone: true}" inputId="preopt11">
              </p-radioButton>
            </label>
            <label>
              <p-radioButton class="any-playbook" name="group12" value="OR" (click)="changeLogicEdit(2)"
                label="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerAny}}"
                [(ngModel)]="playbookModel.cfaOperator" [ngModelOptions]="{standalone: true}" inputId="preopt12">
              </p-radioButton>
            </label>
            <p-radioButton name="group13" value="LOGIC" (click)="changeLogicEdit(3)"
              label="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerLogic}}"
              [(ngModel)]="playbookModel.cfaOperator" [ngModelOptions]="{standalone: true}" inputId="preopt13">
            </p-radioButton>
            <div class="playbook-edit-help-icon"><img src="../assets/img/microinteraction/helptext.svg"
                tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.tooltip}}"
                placement="right"></div>
          </div>
        </div>
      </div>
      <div *ngIf="playbookModel.cfaOperator=='LOGIC'" class="logic">
        <h6>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.LogicTitle}}</h6>
        <input type="text"
          placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.LogicTitle}}"
          [(ngModel)]="playbookModel.cfaLogic" formControlName="cfaLogic" class="ipt-logic">
      </div>
      <span *ngIf="errorValidation.logicError!=null && playbookModel.cfaOperator=='LOGIC'"
        class="errormsg-topic">{{errorValidation.logicError}}</span>
      <div class="action">
        <h4>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.action}}
          <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
              tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.tooltip}}"
              placement="right"></span>
        </h4>
        <div style="margin-top: 16px;margin-bottom: 24px;"
          *ngFor="let actionEdit of playbookModel.callActionList;let j=index">
          <div class="row">
            <div class="col-md-5">
              <!-- <div class="form-group"> -->
              <p-dropdown class="playbook-action-dropdwn dplable" [options]="CallToActionItems" filter="true"
                [(ngModel)]="actionEdit.callActionId"
                placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.select}}"
                [ngModelOptions]="{standalone: true}"></p-dropdown>
              <!-- </div> -->
              <!-- <p-dropdown class="playbook-action-dropdwn" [options]="CallToActionItems"
                [(ngModel)]="actionEdit.callActionId" [ngModelOptions]="{standalone: true}"
                placeholder="Select a Action"  [showClear]="true"></p-dropdown> -->
            </div>
            <div style="padding: 5px 0px 8px 0px; margin-left: -4px;">
              <img src="../assets/img/microinteraction/delete.svg" (click)="removeActionEdit(j)">
            </div>

          </div>
        </div>
        <span *ngIf="errorValidation.actionError!=null"
          class="errormsg-topic">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.actionError}}</span>

        <div>
          <button type="button" style="outline: 0px;" class="add-btn" (click)="addAction()">
            <img src="../assets/img/microinteraction/add_item.svg">
            <span
              class="btn-txt-add">&nbsp;{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.add}}</span>
          </button>
        </div>
      </div>
      <div class="errormsg-topic" *ngIf="isValidateFilter ||metricOptionErr || metricValueErr || isFilterTimeError || isFilterEqualTimeError || isFilterErr">Please Complete the Filter Conditions</div>
      <!-- <div class="errormsg-topic" *ngIf="">Filter condition doesnot satisfied,Please Validate</div> -->
      <div class="save-cancel">
        <button type="button" class="btn-save" *ngIf = "global.rolePermissions.playbooks.myPlaybooks.isViewEdit == true"
          (click)="updatePlaybooks()" [disabled]="loading">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.saveCancel?.save}}</button>
        <button type="button" class="btn-cancel"
          (click)="editCancel()">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.saveCancel?.cancel}}</button>
      </div>
      <!-- </div> -->
    </form>
  </div>

</div>

<!-- ***********************************************Create a Playbooks*********************************************** -->
<div style="margin: 40px 195px 50px 32px;min-height: 100vh;" *ngIf="createEdit== 'create'">
  <div>
    <img src="../../../../assets/img/back.svg">
    <ul class="breadcrumb">
      <li><label class="bread-crumb-label1" style="cursor: pointer;"
          (click)="createCancel()">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.breadcrumb}}</label></li>
    </ul>
  </div>
  <div class="edit-header">
    <div class="row" style="justify-content:space-between;margin-bottom: 18px !important;">
      <div class="page-title col-sm-6">
        <h2>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.createTilte}}</h2>
      </div>
    </div>
  </div>

  <div>
    <form [formGroup]="playbookCreateForm">
      <!--(ngSubmit)="onSubmitCreate()"-->
      <div class="form-group">
        <div class="row" style="margin-top: 30px;">
          <div class="col-sm-6">
            <div class="row">
              <div class="col-sm-12 name-description" style="margin-bottom: 4px;">
                <span>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookName}}</span>
                <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
                    tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.tooltipName}}"
                    placement="right"></span>
                <span style="float: right;font-weight: 400 !important">44
                  {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.characters}}</span>
              </div>
              <div class="col-sm-12">
                <input type="text" id="playbooknameid"  class="form-control ipt-edit" maxlength="44" autocomplete="off"
                  [(ngModel)]="playbookModel.playbookName"  (keypress)="omit_special_char($event)" (ngModelChange)="onPaste($event)" formControlName="playbookName"
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookName}}"
                  [ngClass]="{ 'is-invalid': (submitted ||validationCreate.playbookName.touched) && validationCreate.playbookName.errors}"
                  style="height: 56px;">
                <div
                  *ngIf="(submitted || validationCreate.playbookName.touched) && validationCreate.playbookName.errors"
                  class="is-invalid ">
                  <div class="errormsg-topic is-invalid"
                    *ngIf="(submitted || validationCreate.playbookName.touched) && validationCreate.playbookName.errors.required"
                    style="padding: initial;">
                    {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookNameError}}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-sm-6 ">
            <div class="row">
              <div class="col-sm-12 name-description" style="margin-bottom: 4px;">
                <span>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookDescription}}</span>
                <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
                    tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.tooltipDesc}}"
                    placement="right"></span>
                <span style="float: right;font-weight: 400 !important">70
                  {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.characters}}</span>
              </div>
              <div class="col-sm-12">
                <input type="text" class="form-control ipt-edit" maxlength="70" name="name" autocomplete="off"
                  [(ngModel)]="playbookModel.playbookDescription" [ngModelOptions]="{standalone: true}" 
                  placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookDescription}}"
                  style="height: 56px;">
              </div>

            </div>
          </div>

        </div>

      </div>

      <p-overlayPanel #op for="op" [showCloseIcon]="true" appendTo="body" [style]="{width: '830px'}"   [dismissable]="false">
        <div class="p-3">
          <div class="source-title mb-3">Define rules</div>
          <div class=" mb-2 ">
            <div style="display: flex;">
            <label>
              <p-radioButton name="group1" value="all"  [(ngModel)]="playbookModel.filterConditionType"  [ngModelOptions]="{standalone: true}" label="All criteria met" inputId="preopt1" >
              </p-radioButton>
           </label>
           <label>
            <p-radioButton name="group2" value="any"  [(ngModel)]="playbookModel.filterConditionType"  [ngModelOptions]="{standalone: true}" label="Any criteria met" inputId="preopt2">
            </p-radioButton>
          </label>
          </div>
          </div>
          <div class="filter-section border-0" >
          <div class="row mb-3 ml-1 " style="display: flex;"  *ngFor="let create of playbookModel.filterConditions; let i=index">
            <div>
              <p-dropdown class="dp-label" [style]="{'width':'220px'}" [options]="metricOption" [(ngModel)]="create.conditionFilterName"  [ngModelOptions]="{standalone: true}" placeholder="Select"
             (onChange)="filterMetricNameValidation(create.conditionFilterName,i)"></p-dropdown>
            </div>
            <div style="padding-left: 20px;" *ngIf="create.conditionFilterName != 'Media Type' && create.conditionFilterName != 'Interaction Start Time (UTC)'">
              <p-dropdown [style]="{'width':'190px'}" class="dplable" [options]="listDropdown" [(ngModel)]="create.conditionFilterType"
                placeholder="Select Filter Type"
                [ngModelOptions]="{standalone: true}" [disabled]="create.conditionFilterName === null"></p-dropdown>
            </div>
            <div style="padding-left: 20px;" *ngIf="create.conditionFilterName == 'Media Type'">
              <p-multiSelect class="multiselect-custom-virtual-scroll data-access-ddl" [style]="{'width':'260px'}" [options]="mediaTypeOption" [(ngModel)]="create.conditionFilterValue" [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} data selected" (ngModelChange)="filterMetricOnChange(create.conditionFilterValue,i,'createmetric')" defaultLabel="Select "  [virtualScroll]="true" itemSize="34"  [showToggleAll]="false"></p-multiSelect>
            </div>
            <div style="padding-left: 20px;" *ngIf="create.conditionFilterName != 'Media Type' && create.conditionFilterName != 'Interaction Start Time (UTC)'">
              <p-multiSelect class="multiselect-custom-virtual-scroll data-access-ddl" [style]="{'width':'260px'}" [options]="metricValueOption" [(ngModel)]="create.conditionFilterValue" [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} data selected" (ngModelChange)="filterMetricOnChange(create.conditionFilterValue,i,'createmetric')"  defaultLabel="Select value" (onFocus)="getMetricValueData(create.conditionFilterName)" [virtualScroll]="true" itemSize="34"  [showToggleAll]="false" [disabled]="create.conditionFilterType == null" ></p-multiSelect>
            </div>
            <div style="padding-left: 20px;" *ngIf="create.conditionFilterName == 'Interaction Start Time (UTC)'">
              <p-multiSelect class="multiselect-custom-virtual-scroll data-access-ddl" [style]="{'width':'190px'}" [options]="filterWeekDays" [(ngModel)]="create.conditionFilterValue" [ngModelOptions]="{standalone: true}" maxSelectedLabels="0" selectedItemsLabel="{0} data selected" (ngModelChange)="filterMetricOnChange(create.conditionFilterValue,i,'createmetric')"  defaultLabel="Select day of week"  [virtualScroll]="true" itemSize="34"  [showToggleAll]="false" ></p-multiSelect>
            </div>
            <div  class="d-flex" *ngIf="create.conditionFilterName == 'Interaction Start Time (UTC)'">
              <div class="d-flex" style="padding-left: 20px;">
                <p-calendar class="timer-input"   [(ngModel)]="create.conditionFilterStartTime" [ngModelOptions]="{standalone: true}" [timeOnly]="true" [hourFormat]="24" inputId="timeonly" [readonlyInput]="true"  (ngModelChange)="filterTimeOnChange(create.conditionFilterStartTime,create.conditionFilterEndTime)" placeholder="Start Time" [disabled]="create.conditionFilterValue.length == 0"></p-calendar>
                <i class="fa fa-clock-o clock-icon" aria-hidden="true"></i>
              </div>
                <div class="d-flex" style="padding-left: 5px;">
                  <p-calendar class="timer-input"  [(ngModel)]="create.conditionFilterEndTime" [ngModelOptions]="{standalone: true}" [timeOnly]="true" [hourFormat]="24" inputId="timeonly" [readonlyInput]="true"  (ngModelChange)="filterTimeOnChange(create.conditionFilterStartTime,create.conditionFilterEndTime)" placeholder="End Time" [disabled]=" create.conditionFilterStartTime == null"></p-calendar>
                  <i class="fa fa-clock-o clock-icon" aria-hidden="true"></i>
                </div>
            </div>
                
          
            <div>
              <button class="btn-delete-icon" type="button" (click)="removeFilterConditionCreate(i,'removecreate')" 
                style="margin-top: 3px;" [ngStyle]="{ 'margin-left': create.conditionFilterName == 'Interaction Start Time (UTC)' ? '0px' : '16px'}">
                <img src="../assets/img/microinteraction/delete.svg" style="margin-left: -5px;margin-top: 3px;width: 16px;">
              </button>
            </div>
          </div>
          </div>
          <div class="errormsg-topic" *ngIf="metricOptionErr">Cannot choose same filter option, once if option is already existed! </div>
          <div class="errormsg-topic" *ngIf="metricValueErr">Please select atleast 1 filter condition option</div>
          <div class="errormsg-topic" *ngIf="addConditionErr">Condition is already Exist,Please select option</div>
          <div class="errormsg-topic" *ngIf="isFilterTimeError">Interaction End Time must be greater than of Interaction Start Time! </div>
          <div class="errormsg-topic" *ngIf="isFilterEqualTimeError">Cannot choose Interaction Start Time as Interaction End Time!</div>
          <div class="errormsg-topic" *ngIf="isFilterErr">Please Choose the Interaction Start Time and Interaction End Time!</div>
          <div class="d-flex justify-content-between mt-2 ml-0" >
            <button type="button" class="add-btn"   (click)="addFilterConditionCreate('createcondition')" [disabled]="isAddDisable">
              <label class="d-flex" style="align-items: center;text-decoration: none;" [ngClass]="{'btn-txt-add' : !isAddDisable , 'btn-txt-grey': isAddDisable }" >
                <span  style="font-size: 28px;">+ </span>&nbsp;
                <span  class="pt-1">Add Criteria</span>
              </label>
            </button>
            <div>
              <button type="button" class="btn-save" style="float: right" [ngClass]="{'btn-save' : !isDisableDone , 'btn-save-disable': isDisableDone}" (click)="addFilterDefinition($event,op)" [disabled]="isDisableDone" >Done</button>
            </div>
          </div>
        </div>
      </p-overlayPanel> 



      <div class="edit-condition">
        <div class="d-flex">
        <h4>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.Conditions}}
          <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
              tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.tooltip}}"
              placement="right"></span>
        </h4>
        <label class="ml-2">
          <button type="button" style="outline: 0px;" class="add-btn" (click)="op.show($event)">
            <span class="btn-con-add">Filters&nbsp;</span>
              <img src="../assets/img/microinteraction/edit.svg">
            </button>
        </label>
        </div>
        <p>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.ConditionDesc}}</p>

        <div style="display:flex;margin-bottom: 6px;" *ngFor="let con of playbookModel.cfacondition; let i=index">
          <div class="no-div">
            <h6>{{i+1}}</h6>
          </div>
          <div class="form-group mr-3">
            <p-dropdown class="choose-action dplable" [options]="conditionDdl" [(ngModel)]="con.Dimension"
              placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.category}}"
              [ngModelOptions]="{standalone: true}" (ngModelChange)="defaultChannelVal(con)"></p-dropdown>
          </div>
          <div class="form-group mr-3" *ngIf="con.Dimension == 'Metrics'">
            <p-dropdown class="theme-selection dplable" [options]="metricOptions" [(ngModel)]="con.Metrics" 
              placeholder="Select a Metrics" [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>
          <div class="form-group mr-3" *ngIf="con.Dimension == 'Metrics'">
            <p-dropdown class="choose-Condition dplable" [options]="metricOperations" [(ngModel)]="con.Condition" 
              placeholder="Select a Operation" [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>
          <div class="form-group mr-3"  *ngIf="con.Dimension == 'Metrics'&& con.Condition == '>=<='">
            <input type="text" class="score-theme form-control choose-content" [(ngModel)]="con.Measure"
              [ngModelOptions]="{standalone: true}" placeholder="1-10" max="100" (keypress)="keyPress($event)"/>
          </div>
          <!-- <div class="form-group" style="margin-left: 12px;" *ngIf="con.Dimension == 'Metrics' && con.Condition == '>=<='">
            <input type="number" class="score-theme form-control choose-content metric-number-type" [(ngModel)]="con.measureFrom"
              [ngModelOptions]="{standalone: true}" max="100" />
          </div>
          <div *ngIf="con.Dimension == 'Metrics'&& con.Condition == '>=<='" class="and-value">AND</div>
          <div class="form-group" style="margin-left: 12px;" *ngIf="con.Dimension == 'Metrics'&& con.Condition == '>=<='">
            <input type="number" class="score-theme form-control choose-content metric-number-type" [(ngModel)]="con.measureTo"
              [ngModelOptions]="{standalone: true}" max="100" />
          </div> -->
          <div class="form-group mr-3" *ngIf="con.Dimension == 'Sentiment'">
            <p-dropdown class="choose-condition dplable" [options]="channelList" [(ngModel)]="con.Channel" 
              placeholder="Select a Channel" [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>
          <div class="form-group mr-3" *ngIf="con.Dimension!='Score' && con.Dimension != 'Metrics'">
            <p-dropdown class="choose-condition dplable" [options]="topicSentimentCondition" [(ngModel)]="con.Condition"
              placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.operation}}"
              [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>

          <div class="form-group mr-3" *ngIf="con.Dimension=='Score'">
            <p-dropdown class="theme-selection dplable" [options]="themeLists" [(ngModel)]="con.Theme" filter="true"
              placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.theme}}"
              [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>

          <div class="form-group mr-3" *ngIf="con.Dimension=='Score'">
            <p-dropdown class="choose-Condition dplable" [options]="scoreCondition" [(ngModel)]="con.Condition"
              placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.operation}}"
              [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>

          <div class="form-group mr-3" *ngIf="con.Dimension!='Score'&& con.Dimension!='Sentiment' && con.Dimension != 'Metrics'">
            <p-dropdown class="choose-content dplable" [options]="TopicsList" [(ngModel)]="con.Measure" filter="true"
              placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.value}}"
              [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>
          <div class="form-group mr-3"  *ngIf="con.Dimension=='Score'|| (con.Dimension == 'Metrics' && con.Condition != '>=<=')">
            <input type="number" class="score-theme form-control choose-content" [(ngModel)]="con.Measure"
              [ngModelOptions]="{standalone: true}" max="100" />
            <!-- <img src="../assets/img/microinteraction/helptext.svg"
                     tooltip="Enter a score number. It could be a positive or negative number between 1 and 100." placement="right"/> -->
          </div>
          <div class="form-group mr-3" *ngIf="con.Dimension=='Sentiment'">
            <p-dropdown class="choose-condition dplable" [options]="sentimentList" [(ngModel)]="con.Measure"
              placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.value}}"
              [ngModelOptions]="{standalone: true}"></p-dropdown>
          </div>
          <div>
            <button class="btn-delete-icon" type="button" (click)="removeConditionCreate(i)"
              style="margin-left: 8px;margin-top: 4px;">
              <img src="../assets/img/microinteraction/delete.svg" style="margin-left: -13px;margin-top: 3px;">
            </button>
          </div>
        </div>

        <!-- <span class="errormsg-topic" style="  position: relative; top: -14px;"
          *ngIf="errorValidation.conditionError!=null ">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.conditionError}}</span> -->
        <span class="errormsg-topic" style="  position: relative; top: -14px;"
          *ngIf="errorValidation.conditionError!=null && errorValidation.conditionError!='' ">{{errorValidation.conditionError}}</span>
        <div class="errormsg-topic" *ngIf="errBetween == true" style=" position: relative; top: -14px;">“Between” operator requires a range like 1-10</div>
        <div class="errormsg-topic" *ngIf="errSameValue == true" style=" position: relative; top: -14px;">“Between” operator do not accept a same range (1-1)</div>
        <div>
          <button type="button" class="add-btn" style="margin-bottom: 24px;outline: 0px;"
            (click)="addConditionCreate()">
            <img src="../assets/img/microinteraction/add_item.svg">
            <span
              class="btn-txt-add">&nbsp;{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookCondition?.addCondition}}</span>
          </button>
        </div>
        <div class="trigger-condition">
          <div>
            <h5>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerTitle}}
              <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
                  tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.tooltipTrigger}}"
                  placement="right"></span>
            </h5>
          </div>
          <div style="display: flex;">
            <p-radioButton name="group21" value="AND" (click)="changeLogicCreate(1)"
              label="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerall}}"
              [(ngModel)]="playbookModel.cfaOperator" [ngModelOptions]="{standalone: true}" inputId="preopt1">
            </p-radioButton>
            <p-radioButton class="any-playbook" name="group22" value="OR" (click)="changeLogicCreate(2)"
              label="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerAny}}"
              [(ngModel)]="playbookModel.cfaOperator" [ngModelOptions]="{standalone: true}" inputId="preopt3">
            </p-radioButton>
            <p-radioButton name="group23" value="LOGIC" (click)="changeLogicCreate(3)"
              label="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.triggerLogic}}"
              [(ngModel)]="playbookModel.cfaOperator" [ngModelOptions]="{standalone: true}" inputId="preopt4">
            </p-radioButton>
            <div class="playbook-edit-help-icon"><img src="../assets/img/microinteraction/helptext.svg"
                tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.tooltip}}"
                placement="right"></div>
          </div>
        </div>
      </div>
      <div class="logic" *ngIf="LOGIC">
        <h6>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.LogicTitle}}</h6>
        <input type="text"
          placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookTrigger?.LogicTitle}}"
          [(ngModel)]="playbookModel.cfaLogic" [ngModelOptions]="{standalone: true}" class="ipt-logic">
      </div>
      <span *ngIf="errorValidation.logicError!=null" class="errormsg-topic">{{errorValidation.logicError}}</span>
      <div class="action">
        <h4>{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.action}}
          <span class="tooltip-content"><img src="../../../../assets/img/microinteraction/helptext.svg"
              tooltip="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.tooltip}}"
              placement="right"></span>
        </h4>
        <div style="margin-top: 16px;margin-bottom: 24px;"
          *ngFor="let selectCity of playbookModel.callActionList;let j=index">
          <div class="row">
            <div class="col-md-5">
              <p-dropdown class="playbook-action-dropdwn dplable" [options]="CallToActionItems"
                [(ngModel)]="selectCity.callActionId" [ngModelOptions]="{standalone: true}" filter="true"
                placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.select}}">
              </p-dropdown>
            </div>
            <div style="margin-top: 4px;">
              <button class="btn-delete-icon" type="button" (click)="removeActionCreate(j)"> <img
                  src="../assets/img/microinteraction/delete.svg"></button>
            </div>
          </div>

        </div>
        <span *ngIf="errorValidation.actionError!=null"
          class="errormsg-topic">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.actionError}}</span>
        <div>
          <button type="button" style="outline: 0px;" class="add-btn" (click)="addActionCreate()">
            <img src="../assets/img/microinteraction/add_item.svg">
            <span
              class="btn-txt-add">&nbsp;{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookAction?.add}}</span>
          </button>
        </div>
      </div>
      <div class="errormsg-topic" *ngIf="isValidateFilter ||metricOptionErr || metricValueErr || isFilterTimeError || isFilterEqualTimeError || isFilterErr">Please Complete the Filter Conditions</div>
      <div class="save-cancel">
        <button type="button" class="btn-save"
          (click)="playbookCreate()" [disabled]="loading">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.saveCancel?.save}}</button>
        <button type="button" class="btn-cancel"
          (click)="createCancel()">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.saveCancel?.cancel}}</button>
      </div>
    </form>
  </div>

</div>

<!-- ***********************************************Playbook Template cards*********************************************** -->
<div style="margin: 40px 110px 0 32px;" *ngIf="createEdit== 'template'">
  <div>
    <img src="../../../../assets/img/back.svg">
    <ul class="breadcrumb" style="background-color: #eee;">
      <li><label class="bread-crumb-label1"
          (click)="breadcrumbPlaybook('list')">{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.breadcrumb}}</label>
      </li>
    </ul>
  </div>
  <div class="playbook-header">
    <div class="page-title">
      <h2>{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.title}}</h2>
    </div>
  </div>
  <section style="margin: 24px 0;">
    <div class="row" *ngIf = "global.rolePermissions.playbooks.myPlaybooks.isViewEdit == true || global.rolePermissions.playbooks.myPlaybooks.isView == true">
      <div class="col-sm-6 col-lg-3" *ngFor="let templateCards of templateList">
        <!--*ngFor="let templateCards of playbookTemplateList"-->
        <div class="card">
          <div style="display: flex;">
            <div style="width:6%">
              <img src="../assets/img/TilePatterns/Pattern_Playbooks.svg">
            </div>
            <div class="card-body bg-template">
              <div class="playbook-template">
                {{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.template}}
              </div>
              <div class="card-title  module line-clamp">{{templateCards?.playbookName}}</div>
              <div class="card-desc-template module line-clamp-template-desc">{{templateCards?.playbookDescription}}
              </div>
              <!-- <br><br> -->
              <footer style="position: absolute;
                bottom: 15px;">
                <div><label class="template-links"
                    (click)="viewTemplate(templateCards)">{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.view}}</label>
                </div>
                <div *ngIf = "global.rolePermissions.playbooks.myPlaybooks.isViewEdit == true"><label class="template-links"
                    (click)="copyTemplate(templateCards)">{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.copy}}</label>
                </div>
              </footer>
            </div>
          </div>

        </div>
      </div>
      <!--  -->

    </div>
  </section>
</div>

<!--*********************************************** playbook template -- view details*********************************************** -->


<div style="margin: 40px 220px 50px 32px;" *ngIf="createEdit== 'templateCard'">
  <div>
    <img src="../../../../assets/img/back.svg">
    <ul class="breadcrumb">
      <li><label class="bread-crumb-label1"
          (click)="breadcrumbPlaybook('list')">{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.breadcrumb}}</label>
      </li>
      <li><label class="bread-crumb-label1" (click)="breadcrumbPlaybook('template')">
          {{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.viewDetails?.breadCrumb}}</label></li>
    </ul>
  </div>
  <div class="edit-header">
    <div style="display: flex;">
      <div class="page-title" style="padding-right: 16px;">
        <h2>{{playbookTemplateList.playbookName}}</h2>
      </div>
      <div>
        <div class="playbook-template" style="margin-top: 8px;">
          {{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.template}}
        </div>
      </div>

    </div>
  </div>

  <div>
    <form>
      <div class="row" style="margin-top: 30px;">
        <div class="col-sm-6">
          <div class="row">
            <div class="col-sm-12 ">
              <span
                class="name-description">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookName}}</span>
              <span style="float: right;">44
                {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.characters}}</span>
            </div>
            <div class="col-sm-12">
              <input type="text" class="form-control ipt-edit"
                placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookName}}"
                [(ngModel)]="playbookTemplateList.playbookName" [ngModelOptions]="{standalone: true}"
                style="height: 56px; background: none;" disabled>
            </div>

          </div>

        </div>
        <div class="col-sm-6 ">
          <div class="row">
            <div class="col-sm-12">
              <span
                class="name-description">{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookDescription}}</span>
              <span style="float: right;">70
                {{global.language?.playbooks?.myPlaybooks?.createPlaybook?.characters}}</span>
            </div>
            <div class="col-sm-12">
              <input type="text" class="form-control ipt-edit" name="name"
                placeholder="{{global.language?.playbooks?.myPlaybooks?.createPlaybook?.playbookDescription}}"
                [(ngModel)]="playbookTemplateList.playbookDescription" [ngModelOptions]="{standalone: true}"
                style="height: 56px;background: none" disabled>
            </div>

          </div>
        </div>
      </div>

      <div class="edit-condition">
        <h4>{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.viewDetails?.topics}}</h4>
        <div class="row" *ngFor="let templateTopic of playbookTemplateList.topic">
          <div class="col-md-6">
            <button class="tag-value" style="width: 100%; text-align: left; padding: 0 16px;">
              {{templateTopic.topicName}}

            </button>
          </div>
        </div>
        <!-- <p>Define conditions that will trigger the Action(s) below.</p> -->
        <!-- <div>
          <div style="display: flex;" *ngFor="let cond_Template of conditionTemplate;let e=index">
            <div class="no-div">
              <h6>{{e+1}}</h6>
            </div>
            <div class="form-group">
              <p-dropdown class="choose-action" [options]="topics" [(ngModel)]="e.condition"
                [ngModelOptions]="{standalone: true}" placeholder="Select a Category" optionLabel="name" disabled></p-dropdown>
            </div>
            <div class="form-group">
              <p-dropdown class="choose-condition" [options]="operations" [(ngModel)]="e.operation"
                [ngModelOptions]="{standalone: true}" placeholder="Select a Operation" optionLabel="name" disabled></p-dropdown>
            </div>
            <div class="form-group">
              <p-dropdown class="choose-content" [options]="dataValue" [(ngModel)]="e.value"
                [ngModelOptions]="{standalone: true}" placeholder="Select a Value" optionLabel="name" disabled></p-dropdown>
            </div>
            <div>
              <button type="button" class="btn-delete-icon" (click)="deleteCondTemplate(e)" disabled style="margin-left: 8px;margin-top: 4px;">
                <img src="../assets/img/microinteraction/delete.svg" style="margin-left: -13px;margin-top: 3px;">
              </button>
            </div>
          </div>
        </div> -->
        <!-- <div  style="align-items: center;margin-bottom: 24px;" *ngFor="let cond_Template of conditionTemplate;let e=index">
              <div class="row">
                <div class="col-sm-1" style="padding-right:0px">               
                    <div class="no-div"><h6>{{e+1}}</h6></div>
                  </div>
                     <div class="col-sm-3" style="padding-left: 0px;">
                       <div class="form-group">               
                       <p-dropdown class="choose-action"[options]="topics"  [(ngModel)]="e.condition"  [ngModelOptions]="{standalone: true}" placeholder="Select a Category" optionLabel="name" [showClear]="true"></p-dropdown>
                     </div>
                    </div>   
                  <div class="col-sm-3">
                    <div class="form-group">
                     <p-dropdown class="choose-condition"[options]="operations" [(ngModel)]="e.operation" [ngModelOptions]="{standalone: true}" placeholder="Select a Operation" optionLabel="name" [showClear]="true"></p-dropdown>
                   </div>
                  </div>  
                  <div class="col-sm-4">
                    <div class="form-group">  
                     <p-dropdown class="choose-content"[options]="dataValue" [(ngModel)]="e.value" [ngModelOptions]="{standalone: true}" placeholder="Select a Value" optionLabel="name" [showClear]="true"></p-dropdown>
                   </div>
                 </div>
                 <div class="col-sm-1">
                  <div class="form-group">
                    <button class="btn-delete-icon" (click)="deleteCondTemplate(e)"> 
                      <img src="../assets/img/microinteraction/delete.svg"style="margin-left: -13px;margin-top: 3px;">
                    </button>
                  </div>
                </div>
              </div>
            </div> -->
        <!-- <div>
          <button type="button" class="add-btn" style="margin-bottom: 24px;outline: 0px;"
            (click)="addConditionTemplate()" disabled>
            <img src="../assets/img/microinteraction/add_item.svg">
            <span class="btn-txt-add">&nbsp;Add Condition</span>
          </button>
        </div> -->
        <!-- <div class="trigger-condition">
          <div>
            <h5>Trigger the Action when:</h5>
          </div>
          <div style="display: flex;">
            <label>
              <p-radioButton name="group31" value="AllCondition" (click)="changeLogic(1)" label="All conditions occur"
                [(ngModel)]="triggerAction" [ngModelOptions]="{standalone: true}" inputId="preopt23" disabled></p-radioButton>
            </label>
            <label>
              <p-radioButton class="any-playbook" name="group32" value="Any" (click)="changeLogic(2)" label="Any conditions occur"
                [(ngModel)]="triggerAction" [ngModelOptions]="{standalone: true}" inputId="preopt24" disabled></p-radioButton>
            </label>
            <p-radioButton name="group33" value="Logic" (click)="changeLogic(3)" disabled label="Use custom logic"
              [(ngModel)]="triggerAction" [ngModelOptions]="{standalone: true}" inputId="preopt25"></p-radioButton>
            <div class="playbook-edit-help-icon"><img src="../assets/img/microinteraction/helptext.svg"  tooltip="Similar to VBA code in Excel, refer to the condition numbers and write a custom logic script using parentheses, “and,” “not,” “or.” 
                Example “Any of (1, 2 or 3); but not 4”" placement="right"></div>
          </div>
        </div> -->
      </div>
      <!-- <div class="logic" *ngIf="logic" >
        <h6>Enter custom logic script</h6>
        <input type="text" placeholder="Custome Logic" class="ipt-logic" style="margin-bottom: -16px;" disabled>
      </div> -->
      <div class="action" style="margin-top: 16px;">
        <!--*ngIf="!logic"-->
        <h4>{{global.language?.playbooks.myPlaybooks?.playbookLibrary?.viewDetails?.themes}}</h4>
        <div class="row" *ngFor="let templateTheme of playbookTemplateList.themes">
          <div class="col-md-6">
            <button class="themes-template-value" style="width: 100%; text-align: left; padding: 0 16px;">
              {{templateTheme.strategyName}}

            </button>
          </div>
        </div>
        <!-- <div style="margin: 16px 0;" *ngFor="let temp_Action of playbookTemplate_action; let event= index">
          <div class="row">
            <div class="col-md-5">
              <p-dropdown class="playbook-action-dropdwn" [options]="cities" placeholder="Select a City"
                [(ngModel)]="temp_Action.selectedCity" [ngModelOptions]="{standalone: true}" optionLabel="name" disabled></p-dropdown>
            </div>
            <div style="margin-top: 4px;">
              <button type="button" class="btn-delete-icon" (click)="deleteActionTemplate(event)" disabled> <img
                  src="../assets/img/microinteraction/delete.svg"></button>
            </div>

          </div>
        </div> -->
        <!-- <div>
          <button type="button" style="outline: 0px;" class="add-btn" (click)="addActionTemplate()" disabled>
            <img src="../assets/img/microinteraction/add_item.svg">
            <span class="btn-txt-add">&nbsp;Add Action</span>
          </button>
        </div> -->
      </div>
      <div class="copy-back">
        <button type="submit" class="btn-save" *ngIf = "global.rolePermissions.playbooks.myPlaybooks.isViewEdit == true" style="width: 177px;"
          (click)="copyTemplate(playbookTemplateList)" [disabled]="loading">{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.saveCancel?.copy}}</button>
        <button type="button" class="btn-cancel" style="width: 101px;"
          (click)="breadcrumbPlaybook('template')">{{global.language?.playbooks?.myPlaybooks?.playbookLibrary?.saveCancel?.back}}</button>
      </div>
    </form>
  </div>
</div>

<!-- Spinner wheel for playbook template-->
<div style="text-align: center;" *ngIf="istableGet">
  <p-progressSpinner></p-progressSpinner>
</div>
<!-- ***********************************************Delete Confirm box ***********************************************-->
<div class="modal" id="myModal" data-backdrop="static">
  <div class="modal-dialog">
    <div class="modal-content delete-popup">

      <!-- Modal Header -->
      <div class="modal-header" style="border-bottom: 0;">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="delete-popup-content">
          <img src="../assets/img/glyphs_messaging/glyph_danger.svg" style="margin-top: -10px;
              margin-right: 20px;">
          <h5>{{global.language?.playbooks?.myPlaybooks?.EditPlaybook?.popupForm?.title}}</h5>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer " style="border-top: 0px;">
        <div style="margin-left: 8.6%;">
          <button type="button" class="btn-pop-del" data-dismiss="modal"
            (click)="deletePlaybook()">{{global.language?.playbooks?.myPlaybooks?.EditPlaybook?.popupForm?.deletebtn}}</button>
          <button type="submit" class="btn-pop-cancel"
            data-dismiss="modal">{{global.language?.playbooks?.myPlaybooks?.EditPlaybook?.popupForm?.cancelbtn}}</button>
        </div>
      </div>

    </div>
  </div>
</div>