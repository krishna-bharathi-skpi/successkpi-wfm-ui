<div class="wfm">
    <p-toast [baseZIndex]="999999"></p-toast>
    <!-- Begin top header -->
    <div class="row top-header">
        <div class="col-md-6">
            <h2 class="title">{{isAddMode ? 'Set Up A Workgroup' : 'Update Workgroup'}}</h2>
        </div>
        <div class="col-md-6 text-right">
            <button pRipple routerLink="/wfm/schedule/workgroup/list" class="cust-btn-outlined">Cancel</button> 
            <button pRipple (click)="submitWorkgroup('continueLater');" class="cust-btn-outlined" *ngIf="global.rolePermissions.work.schedule.isViewEdit == true">Save and Continue Later</button>
            <button pRipple (click)="submitWorkgroup('continue');" class="cust-btn" *ngIf="global.rolePermissions.work.schedule.isViewEdit == true">Save and Continue</button>
        </div>
    </div>
    <!-- End top header -->

    <!-- Begin body content -->
    <form name="workgroupForm" [formGroup]="workgroupForm" novalidate>
        <div style="padding:0px 32px;">

            <!-- Begin wfm config table -->
            <!-- <div class="row" id="wfm_configs_table" *ngIf="wfmConfigs?.length > 0" style="padding-top: 15px;">
                <div class="col-12 cust-table">
                    <h5 id="wfm_config_header" *ngIf="isAddMode" style="font-weight: 600; padding-bottom: 5px;">{{wfmConfigs?.length > 1 ? 'Choose your Configuration' : 'Configuration'}}</h5>
                    <h5 id="wfm_config_header" *ngIf="!isAddMode" style="font-weight: 600; padding-bottom: 5px;">Selected Configuration</h5>
                    <table class="table wfm-table">
                        <thead>
                            <tr>
                                <th *ngIf="wfmConfigs?.length > 1"></th>
                                <th>Platform</th>
                                <th>CX Center</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let config of wfmConfigs" [id]="'table_row_'+config.wfmConfigId">
                                <td *ngIf="wfmConfigs?.length > 1">
                                    <input type="radio" [id]="config.wfmConfigId" value="{{config.wfmConfigId}}" (change)="onChangeConfig(config)" name="configOptions" />
                                </td>
                                <td>{{config.platformName}}</td>
                                <td>{{config.cxCenterName}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div> -->
            <!-- End wfm config table -->
            <!-- <hr class="solid" *ngIf="wfmConfigs?.length > 0" /> -->

            <div class="row">
                <div class="col-12 section-header">
                    <h5>{{isAddMode ? 'Name' : 'Update'}} Your Workgroup</h5>
                    <p>{{isAddMode ? 'First, name' : 'Update'}} your workgroup. Some companies use departments as a workgroup, others use specific organizational structures as workgroups.</p>
                </div>
            </div>
            <!--/.row-->
            <div class="row">
                <div class="col-lg-3 col-md-5">
                    <div class="form-group required">
                        <label class="control-label">Name Your Workgroup</label>
                        <input
                            type="text"
                            class="form-control"
                            formControlName="workgroupName"
                            placeholder="Workgroup Name"
                            [ngClass]="{'is-invalid': (isSubmitted || workgroupForm.controls['workgroupName'].touched) && workgroupForm.controls['workgroupName'].errors }"
                        />
                        <div *ngIf="isSubmitted && workgroupForm.controls['workgroupName'].invalid && workgroupForm.controls['workgroupName'].dirty || workgroupForm.controls['workgroupName'].errors">
                            <small *ngIf="isSubmitted && workgroupForm.controls['workgroupName'].errors?.required" class="errormsg-topic">This field is required. </small>
                            <small *ngIf="isSubmitted && workgroupForm.controls['workgroupName'].errors?.maxlength" class="errormsg-topic">Maximum 50 characters only allowed. </small>
                            <small *ngIf="isSubmitted && workgroupForm.controls['workgroupName'].errors?.pattern" class="errormsg-topic">Workgroup name must contain only alphabets, numbers and the following special characters: hypen & underscore.
                            </small>
                        </div>
                    </div>
                </div>
                <div class="col-lg-1"></div>
                <div class="col-lg-3 col-md-5">
                    <div class="form-group">
                        <label class="control-label">Description</label>
                        <textarea
                            id="workgroupDesc"
                            name="workgroupDesc"
                            formControlName="workgroupDesc"
                            [(ngModel)]="description"
                            rows="4"
                            maxlength="400"
                            class="form-control"
                            placeholder="Type your content here.."
                            [ngClass]="{'is-invalid': (isSubmitted || workgroupForm.controls['workgroupDesc'].touched) && workgroupForm.controls['workgroupDesc'].errors}"
                        ></textarea>
                        <small class="form-text text-muted">characters remaining: <code>{{ (description) ? 400 - description.length : 400 - 0 }}</code>/<code>400</code></small>
                        <div
                            *ngIf="isSubmitted && workgroupForm.controls['workgroupDesc'].invalid && workgroupForm.controls['workgroupDesc'].dirty || workgroupForm.controls['workgroupDesc'].errors"
                        >
                            <small *ngIf="isSubmitted && workgroupForm.controls['workgroupDesc'].errors?.maxlength" class="errormsg-topic">Maximum 400 characters only allowed. </small>
                            <small *ngIf="isSubmitted && workgroupForm.controls['workgroupDesc'].errors?.pattern" class="errormsg-topic">Description must contain only alphabets, numbers and the following special characters: comma, dot, hypen & underscore.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
            <!--/.row-->
            <hr class="solid" />
            <div class="row">
                <div class="col-12 section-header">
                    <h5>Set Adherence</h5>
                    <p>Description of Adherence here.</p>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3">
                    <div class="form-group required">
                        <label class="control-label">Severe Adherence Threshold</label>
                        <input
                            type="text" disabled
                            class="form-control"
                            placeholder=""
                            pKeyFilter="int"
                            maxlength="5"
                        />
                        <!-- <input
                            type="text"
                            class="form-control"
                            formControlName="severeAdherenceThreshold"
                            placeholder=""
                            pKeyFilter="int"
                            maxlength="5"
                            [ngClass]="{'is-invalid': (isSubmitted || workgroupForm.controls['severeAdherenceThreshold'].touched) && workgroupForm.controls['severeAdherenceThreshold'].errors }"
                        />
                        <div *ngIf="isSubmitted && workgroupForm.controls['severeAdherenceThreshold'].invalid && workgroupForm.controls['severeAdherenceThreshold'].dirty || workgroupForm.controls['severeAdherenceThreshold'].errors">
                            <small *ngIf="isSubmitted && workgroupForm.controls['severeAdherenceThreshold'].errors?.required" class="errormsg-topic">This field is required. </small>
                        </div> -->
                    </div>
                </div>
                <div class="col-1"></div>
                <div class="col-lg-3">
                    <div class="form-group required">
                        <label class="control-label">Adherence Exception Threshold</label>
                        <input
                            type="text" disabled
                            class="form-control"
                            placeholder=""
                            pKeyFilter="num"
                            maxlength="5"
                        />
                        <!-- <input
                            type="text"
                            class="form-control"
                            formControlName="adherenceExceptionThreshold"
                            placeholder=""
                            pKeyFilter="num"
                            maxlength="5"
                        />
                        <div *ngIf="isSubmitted && workgroupForm.controls['adherenceExceptionThreshold'].invalid && workgroupForm.controls['adherenceExceptionThreshold'].dirty || workgroupForm.controls['adherenceExceptionThreshold'].errors">
                            <small *ngIf="isSubmitted && workgroupForm.controls['adherenceExceptionThreshold'].errors?.required" class="errormsg-topic">This field is required. </small>
                        </div> -->
                    </div>
                </div>
            </div>
            <!--/.row-->
            <div class="row">
                <div class="col-lg-3">
                    <div class="form-group required">
                        <label class="control-label">Adherence Target</label>
                        <input disabled
                            type="text"
                            class="form-control"
                            placeholder=""
                            pKeyFilter="int"
                            maxlength="5"
                        />
                        <!-- <input
                            type="text"
                            class="form-control"
                            formControlName="adherenceTarget"
                            placeholder=""
                            pKeyFilter="int"
                            maxlength="5"
                        />
                        <div *ngIf="isSubmitted && workgroupForm.controls['adherenceTarget'].invalid && workgroupForm.controls['adherenceTarget'].dirty || workgroupForm.controls['adherenceTarget'].errors">
                            <small *ngIf="isSubmitted && workgroupForm.controls['adherenceTarget'].errors?.required" class="errormsg-topic">This field is required. </small>
                        </div> -->
                    </div>
                </div>
                <div class="col-1"></div>
                <div class="col-lg-4">
                    <div class="form-group required">
                        <label class="control-label">Activity Equivalency</label>
                        <div class="col-12">
                            <div style="float:left;padding-right: 10px;margin-left: -15px;">
                                <label class="switch switch-label switch-pill switch-primary" for="activityEquivalency">
                                    <input disabled type="checkbox" class="switch-input" id="activityEquivalency">
                                    <span class="switch-slider" data-checked="&#x2713;" data-unchecked="&#x2715;"></span>
                                  </label>
                            </div>
                            <div style="float:left;">
                                <label>Description of Plan Period Settings</label>
                            </div>
                        </div>  
                    </div>
                </div>
            </div>
            <!--/.row-->
            <div class="row mb-20">
                <div class="col-12">
                    <div class="form-group required">
                        <label class="control-label">Working Outside Shift</label>
                        <div class="col-12">
                            <div style="float:left;padding-right: 10px;margin-left: -15px;">
                                <label class="switch switch-label switch-pill switch-primary" for="workingOutsideShift">
                                    <input disabled type="checkbox" class="switch-input" id="workingOutsideShift">
                                    <span class="switch-slider" data-checked="&#x2713;" data-unchecked="&#x2715;"></span>
                                  </label>
                            </div>
                            <div style="float:left;">
                                <label>Working Outside Shift Considered Exception</label>
                            </div>
                        </div>  
                    </div>
                </div>
            </div>
            <!--/.row-->
            <hr class="solid" />
            <div class="row">
                <div class="col-12 section-header">
                    <h5>Assign Rules</h5>
                    <p *ngIf="isAddMode">Workgroup rules were setup at a global level. Assign these rules here for your workgroup.</p>
                    <p *ngIf="!isAddMode">Existing workgroup rules and values cannot be edited. If you like to update the value, please delete the existing row and add new rule.</p>
                </div>
            </div>
            <!-- <div class="row mb-20">
                <div class="col-md-4">
                    <p-multiSelect disabled [options]="rules" [(ngModel)]="selectedRules" [virtualScroll]="true" optionValue="Key"
                    optionLabel="Value" defaultLabel="Please select rules" [showToggleAll]="false" [ngModelOptions]="{standalone: true}"></p-multiSelect>
                </div>
            </div> -->
            <div class="row mb-20" *ngIf="isAddRowEnabled" id="rule_table">
                <div class="col-12">
                    <table class="dyn-table">
                        <thead *ngIf="newRules.length">
                            <tr>
                                <!-- <th class="num-col">Type</th> -->
                                <th class="text-col">Category</th>
                                <th class="text-col"></th>
                                <th style="width:225px" *ngIf="subRules.length">
                                    <div class="row">
                                        <div class="col-4"></div>
                                        <div class="col-4"></div>
                                        <!-- <div class="col-4 text-center no-wrap">Is Mandatory</div> -->
                                    </div>
                                </th>
                                <th class="num-col"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let row of newRules; let i = index">
                                <!-- <td class="num-col">
                                    <p-dropdown
                                    [(ngModel)]="row.ruleType"
                                    [options]="ruleTypes"
                                    dataKey="Key"
                                    optionValue="Key"
                                    optionLabel="Value"
                                    [filter]="false"
                                    filterBy="Value"
                                    [showClear]="false"
                                    class="cust-p-dropdown"
                                    placeholder="Select Rule Type"
                                    (onChange)="onChangeRuleType($event)"
                                    [ngModelOptions]="{standalone: true}"
                                    appendTo="body"
                                >
                                </p-dropdown>
                                    <input type="text" class="form-control" placeholder="Rule name" [(ngModel)]="row.ruleName"
                                        [ngModelOptions]="{standalone: true}" /> 
                                </td> -->
                                <td class="text-col">
                                    <p-dropdown
                                        [(ngModel)]="row.ruleCategory"
                                        [options]="ruleCategories"
                                        dataKey="Key"
                                        optionValue="Key"
                                        optionLabel="Value"
                                        [filter]="false"
                                        filterBy="Value"
                                        [showClear]="false"
                                        class="cust-p-dropdown"
                                        placeholder="Select Rule Category"
                                        (onChange)="onChangeRuleCategory(row, $event)"
                                        [ngModelOptions]="{standalone: true}"
                                        appendTo="body"
                                        [disabled]="!row.editable"
                                >
                                    </p-dropdown>
                                    <!-- <input type="text" class="form-control" placeholder="Type" [(ngModel)]="row.ruleCategory"
                                        [ngModelOptions]="{standalone: true}" /> -->
                                </td>
                                <td class="num-col">
                                    <p-dropdown
                                        [(ngModel)]="row.ruleUnit"
                                        [options]="row.ruleUnits"
                                        dataKey="Key"
                                        optionValue="Key"
                                        optionLabel="Value"
                                        [filter]="false"
                                        filterBy="Value"
                                        [showClear]="false"
                                        class="cust-p-dropdown"
                                        placeholder="Select Rule Unit"
                                        (onChange)="onChangeRuleUnit(row, $event)"
                                        [ngModelOptions]="{standalone: true}"
                                        appendTo="body"
                                        [disabled]="!row.editable"
                                >
                                </p-dropdown>
                                    <!-- <input type="text" class="form-control" placeholder="Unit" [(ngModel)]="row.ruleUnit"
                                        [ngModelOptions]="{standalone: true}" /> -->
                                </td>
                                <td style="width:225px">
                                    <div class="row vertical-align" *ngFor="let value of row.rules" style="padding:5px;">
                                        <div class="col-4">
                                            {{value.ruleBoundary}}
                                        </div>
                                        <div class="col-4">
                                            <input type="text" pKeyFilter="int" class="form-control" [(ngModel)]="value.ruleDefaultValue"
                                                [ngModelOptions]="{standalone: true}" maxlength="5" 
                                                [ngClass]="{'is-invalid': value.ruleDefaultValue < 0 || !value.ruleDefaultValue }" 
                                                [disabled]="!row.editable"/>
                                        </div>
                                        <!-- <div class="col-4 text-center">
                                            <p-checkbox [(ngModel)]="value.isMandatory" [binary]="true" [disabled]="!row.editable" [ngModelOptions]="{standalone: true}"></p-checkbox>
                                        </div> -->
                                    </div>
                                </td>
                                <td class="num-col text-right">
                                    <!-- <button type="button" (click)="deleteRow(row)" class="cust-btn-sm btn-rounded btn-delete"
                                        style="font-size:1rem;padding:0 12px"><i class="fa fa-trash-o font-1xl"></i></button> -->
                                        <a (click)="deleteRow(row)" style="color: #959595 !important"><i class="fa fa-trash-o font-1xl" style="font-size: 1.5rem; padding-right: 25px; cursor: pointer;"></i></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row mb-35">
                <div class="col-md-4">
                    <button type="button" (click)="addNewRow()" class="cust-btn-sm"><i class="fa fa-plus font-1xl" style="padding-right:7px;"></i>Add Rule</button>
                    <!-- <button type="button" (click)="saveNewRules()" class="cust-btn-sm">Save</button> -->
                </div>
            </div>
        </div>
        <div class="row action-footer">
            <div class="col-12 text-right">
                <button pRipple routerLink="/wfm/schedule/workgroup/list" class="cust-btn-outlined">Cancel</button>
                <button pRipple (click)="submitWorkgroup('continueLater');" class="cust-btn-outlined" *ngIf="global.rolePermissions.work.schedule.isViewEdit == true">Save and Continue Later</button>
                <button pRipple (click)="submitWorkgroup('continue');" class="cust-btn" *ngIf="global.rolePermissions.work.schedule.isViewEdit == true">Save and Continue</button>
            </div>
        </div>
    </form>
    <!-- End body content -->
</div>
